emotes::install_version("Matrix", version = "1.6.3")
remotes::install_version("Matrix", version = "1.6.3")
install.packages("lme4", type = "source")  # 1.1.35.1
remotes::install_version("Matrix", version = "1.6.4")
library(lme4)
library(metagear)
install.packages("gasanalyzer")
library(gasanalyzer)
#Set the working directory
setwd("/Users/jargrett/Desktop/Castilleja/Data Analysis/Callie Data/HPM")
#load in relevant packages
library(plyr)#for data wrangling and restructuring
library(tidyverse)#for data wrangling and restructuring
library(statmod)
library(lme4)
library(emmeans)#post-hoc analysis
library(car)#for regression analysis
library(ggpubr)#post-hoc analysis
flower <- read.csv("HPM Growth - Flowering.csv")
View(flower)
flower <- read.csv("HPM Growth - Flowering.csv")
str(flower)
flower <- as.data.frame(unclass(leaf),stringsAsFactors=TRUE)
flower <- read.csv("HPM Growth - Flowering.csv")
str(flower)
flower <- as.data.frame(unclass(flower),stringsAsFactors=TRUE)
height <- read.csv("HPM Growth - Height.csv")
str(height)
height <- as.data.frame(unclass(height),stringsAsFactors=TRUE)
leaf <- read.csv("HPM Growth - Leaf_Number.csv")
str(leaf)
leaf <- as.data.frame(unclass(leaf),stringsAsFactors=TRUE)
#bud analysis
ag.flower.lm <- lmer(total_bud ~ treatment*type + (1|replicate_id), data = flower)
summary(ag.flower.lm)
Anova(ag.flower.lm)
emmeans(ag.flower.lm, pairwise ~ type|treatment)
emmip(ag.flower.lm, ~treatment ~ type)
Anova(ag.flower.lm)
#
flower$type <- as.character(flower$type)
flower$type[flower$type == "host-parasite"] <- "With Host"
flower$type[flower$type == "parasite"] <- "Alone"
flower$type <- as.factor(flower$type)
flower$treatment <- as.character(flower$treatment)
flower$treatment[flower$treatment == "innoculated"] <- "Present"
flower$treatment[flower$treatment == "sterilized"] <- "Absent"
flower$treatment <- as.factor(flower$treatment)
ag.bud <- flower %>%
group_by(treatment, type) %>%
dplyr::summarise(mean= mean(total_bud),
se = sd(total_bud)/sqrt(n()))
bud.graph <- ggplot(ag.bud, aes(x = treatment, y = mean, color = type)) +
geom_errorbar(aes(ymin = mean-se, ymax = mean+se),
position =  position_dodge(width = 0.5), size = 1, width = 0.09) +
geom_point(aes(colour=type),shape = 18, size = 7, position =  position_dodge(width = 0.5)) +
labs(x = "Fungi", y = "Number of flower buds") +
scale_color_manual( values=c("#D6A839", "#71A4A0")) +
theme_pubr() +
theme(strip.text = element_text(size = 15),
strip.background = element_blank(),
panel.border = element_rect(fill = "transparent",
color = "gray23", linewidth = 0.12)) +
ylim(0,15)
bud.graph <- ggplot(ag.bud, aes(x = treatment, y = mean, color = type)) +
geom_errorbar(aes(ymin = mean-se, ymax = mean+se),
position =  position_dodge(width = 0.5), linewidth = 1, width = 0.09) +
geom_point(aes(colour=type),shape = 18, size = 7, position =  position_dodge(width = 0.5)) +
labs(x = "Fungi", y = "Number of flower buds") +
scale_color_manual( values=c("#D6A839", "#71A4A0")) +
theme_pubr() +
theme(strip.text = element_text(size = 15),
strip.background = element_blank(),
panel.border = element_rect(fill = "transparent",
color = "gray23", linewidth = 0.12)) +
ylim(0,15)
bud.graph
#time to bud graph
first.bud <- flower %>% drop_na(first_bud)
ggplot(first.bud, aes(x = first_bud, color = type)) +
geom_bar() +
scale_color_manual( values=c("#D6A839", "#71A4A0")) +
labs(x = "Time (Week)", y = "First Bud Observered") +
theme_pubr() +
facet_wrap(~treatment)
bud.graph <- ggplot(ag.bud, aes(x = treatment, y = mean, color = type)) +
geom_errorbar(aes(ymin = mean-se, ymax = mean+se),
position =  position_dodge(width = 0.5), linewidth = 1, width = 0.09) +
geom_point(aes(colour=type, shape = type),shape = 18, size = 7, position =  position_dodge(width = 0.5)) +
labs(x = "Fungi", y = "Number of flower buds") +
scale_color_manual( values=c("#D6A839", "#71A4A0")) +
theme_pubr() +
theme(strip.text = element_text(size = 15),
strip.background = element_blank(),
panel.border = element_rect(fill = "transparent",
color = "gray23", linewidth = 0.12)) +
ylim(0,15)
bud.graph
bud.graph <- ggplot(ag.bud, aes(x = treatment, y = mean, color = type, shape = type)) +
geom_errorbar(aes(ymin = mean-se, ymax = mean+se),
position =  position_dodge(width = 0.5), linewidth = 1, width = 0.09) +
geom_point(aes(colour=type),shape = 18, size = 7, position =  position_dodge(width = 0.5)) +
labs(x = "Fungi", y = "Number of flower buds") +
scale_color_manual( values=c("#D6A839", "#71A4A0")) +
theme_pubr() +
theme(strip.text = element_text(size = 15),
strip.background = element_blank(),
panel.border = element_rect(fill = "transparent",
color = "gray23", linewidth = 0.12)) +
ylim(0,15)
bud.graph
bud.graph <- ggplot(ag.bud, aes(x = treatment, y = mean, color = type, shape = type)) +
geom_errorbar(aes(ymin = mean-se, ymax = mean+se),
position =  position_dodge(width = 0.5), linewidth = 1, width = 0.09) +
geom_point(aes(colour=type),shape = 18, size = 7, position =  position_dodge(width = 0.5)) +
labs(x = "Fungi", y = "Number of flower buds") +
scale_color_manual( values=c("#D6A839", "#71A4A0")) +
theme_pubr() +
theme(strip.text = element_text(size = 15),
strip.background = element_blank(),
panel.border = element_rect(fill = "transparent",
color = "gray23", linewidth = 0.12)) +
ylim(0,15)
bud.graph
bud.graph <- ggplot(ag.bud, aes(x = treatment, y = mean, color = type)) +
geom_errorbar(aes(ymin = mean-se, ymax = mean+se),
position =  position_dodge(width = 0.5), linewidth = 1, width = 0.09) +
geom_point(aes(shape = type),shape = 18, size = 7, position =  position_dodge(width = 0.5)) +
labs(x = "Fungi", y = "Number of flower buds") +
scale_color_manual( values=c("#D6A839", "#71A4A0")) +
theme_pubr() +
theme(strip.text = element_text(size = 15),
strip.background = element_blank(),
panel.border = element_rect(fill = "transparent",
color = "gray23", linewidth = 0.12)) +
ylim(0,15)
bud.graph
ag.leaf <- ggplot(AGPU.leaf, aes(x = week, y = mean, color = type, group = type)) +
geom_point(aes(shape = type), position =  position_dodge(width = 0.5)) +
geom_line(aes(linetype = type), position =  position_dodge(width = 0.5)) +
geom_errorbar(aes(ymin = mean-se, ymax = mean+se),
position =  position_dodge(width = 0.5), width = 0.07) +
scale_color_manual( values=c("#D6A839", "#71A4A0")) +
labs(x = "Time (Week)", y = "Agalinis leaf number") +
theme_pubr() +
facet_wrap(~treatment)
ag.leaf
bud.graph <- ggplot(ag.bud, aes(x = treatment, y = mean, color = type)) +
geom_errorbar(aes(ymin = mean-se, ymax = mean+se),
position =  position_dodge(width = 0.5), linewidth = 1, width = 0.09) +
geom_point(aes(shape = type), size = 7, position =  position_dodge(width = 0.5)) +
labs(x = "Fungi", y = "Number of flower buds") +
scale_color_manual(values=c("#D6A839", "#71A4A0")) +
scale_shape_manual(values=c(10,18)) +
theme_pubr() +
theme(strip.text = element_text(size = 15),
strip.background = element_blank(),
panel.border = element_rect(fill = "transparent",
color = "gray23", linewidth = 0.12)) +
ylim(0,15)
bud.graph
bud.graph <- ggplot(ag.bud, aes(x = treatment, y = mean, color = type)) +
geom_errorbar(aes(ymin = mean-se, ymax = mean+se),
position =  position_dodge(width = 0.5), linewidth = 1, width = 0.09) +
geom_point(aes(shape = type), size = 7, position =  position_dodge(width = 0.5)) +
labs(x = "Fungi", y = "Number of flower buds") +
scale_color_manual(values=c("#D6A839", "#71A4A0")) +
scale_shape_manual(values=c(16,18)) +
theme_pubr() +
theme(strip.text = element_text(size = 15),
strip.background = element_blank(),
panel.border = element_rect(fill = "transparent",
color = "gray23", linewidth = 0.12)) +
ylim(0,15)
bud.graph
bud.graph <- ggplot(ag.bud, aes(x = treatment, y = mean, color = type)) +
geom_errorbar(aes(ymin = mean-se, ymax = mean+se),
position =  position_dodge(width = 0.5), linewidth = 1, width = 0.09) +
geom_point(aes(shape = type), size = 7, position =  position_dodge(width = 0.5)) +
labs(x = "Fungi", y = "Number of flower buds") +
scale_color_manual(values=c("#D6A839", "#71A4A0")) +
scale_shape_manual(values=c(17,18)) +
theme_pubr() +
theme(strip.text = element_text(size = 15),
strip.background = element_blank(),
panel.border = element_rect(fill = "transparent",
color = "gray23", linewidth = 0.12)) +
ylim(0,15)
bud.graph
bud.graph <- ggplot(ag.bud, aes(x = treatment, y = mean, color = type)) +
geom_errorbar(aes(ymin = mean-se, ymax = mean+se),
position =  position_dodge(width = 0.5), linewidth = 1, width = 0.09) +
geom_point(aes(shape = type), size = 7, position =  position_dodge(width = 0.5)) +
labs(x = "Fungi", y = "Number of flower buds") +
scale_color_manual(values=c("#D6A839", "#71A4A0")) +
scale_shape_manual(values=c(18,18)) +
theme_pubr() +
theme(strip.text = element_text(size = 15),
strip.background = element_blank(),
panel.border = element_rect(fill = "transparent",
color = "gray23", linewidth = 0.12)) +
ylim(0,15)
bud.graph
bud.graph <- ggplot(ag.bud, aes(x = treatment, y = mean, color = type)) +
geom_errorbar(aes(ymin = mean-se, ymax = mean+se),
position =  position_dodge(width = 0.5), linewidth = 1, width = 0.09) +
geom_point(aes(shape = type), size = 7, position =  position_dodge(width = 0.5)) +
labs(x = "Fungi", y = "Number of flower buds") +
scale_color_manual(values=c("#D6A839", "#71A4A0")) +
scale_shape_manual(values=c(5,18)) +
theme_pubr() +
theme(strip.text = element_text(size = 15),
strip.background = element_blank(),
panel.border = element_rect(fill = "transparent",
color = "gray23", linewidth = 0.12)) +
ylim(0,15)
bud.graph
bud.graph <- ggplot(ag.bud, aes(x = treatment, y = mean, color = type)) +
geom_errorbar(aes(ymin = mean-se, ymax = mean+se),
position =  position_dodge(width = 0.5), linewidth = 1, width = 0.09) +
geom_point(aes(shape = type), size = 7, position =  position_dodge(width = 0.5)) +
labs(x = "Fungi", y = "Number of flower buds") +
scale_color_manual(values=c("#D6A839", "#71A4A0")) +
scale_shape_manual(values=c(18,18)) +
theme_pubr() +
theme(strip.text = element_text(size = 15),
strip.background = element_blank(),
panel.border = element_rect(fill = "transparent",
color = "gray23", linewidth = 0.12)) +
ylim(0,15)
bud.graph
#time to bud graph
first.bud <- flower %>% drop_na(first_bud)
ggplot(first.bud, aes(x = first_bud, color = type)) +
geom_bar() +
scale_color_manual( values=c("#D6A839", "#71A4A0")) +
labs(x = "Time (Week)", y = "First Bud Observered") +
theme_pubr() +
facet_wrap(~treatment)
#time to bud graph
first.bud <- flower %>% drop_na(first_bud)
ggplot(first.bud, aes(x = first_bud, color = type),
position =  position_dodge(width = 0.5)) +
geom_bar() +
scale_color_manual( values=c("#D6A839", "#71A4A0")) +
labs(x = "Time (Week)", y = "First Bud Observered") +
theme_pubr() +
facet_wrap(~treatment)
#time to bud graph
first.bud <- flower %>% drop_na(first_bud)
ggplot(first.bud, aes(x = first_bud, color = type),
position =  position_dodge(width = 0.5)) +
geom_bar(width = 0.4, position = position_dodge(width = 0.5))
#time to bud graph
first.bud <- flower %>% drop_na(first_bud)
ggplot(first.bud, aes(x = first_bud, color = type),
position =  position_dodge(width = 0.5)) +
geom_bar(width = 0.5, position = position_dodge(width = 0.5))
#time to bud graph
first.bud <- flower %>% drop_na(first_bud)
ggplot(first.bud, aes(x = first_bud, color = type),
position =  position_dodge(width = 0.5)) +
geom_bar(width = 0.5, position = position_dodge(width = 0.5))
#time to bud graph
first.bud <- flower %>% drop_na(first_bud)
ggplot(first.bud, aes(x = first_bud, fill = type),
position =  position_dodge(width = 0.5)) +
geom_bar(width = 0.5, position = position_dodge(width = 0.5))
#time to bud graph
first.bud <- flower %>% drop_na(first_bud)
ggplot(first.bud, aes(x = first_bud, fill = type),
position =  position_dodge(width = 0.5)) +
geom_bar(width = 0.5, position = position_dodge(width = 0.5)) +
scale_fill_manual( values=c("#D6A839", "#71A4A0")) +
labs(x = "Time (Week)", y = "First Bud Observered") +
theme_pubr() +
facet_wrap(~treatment)
flower$treatment <- as.character(flower$treatment)
flower$treatment[flower$treatment == "innoculated"] <- "Fungi Present"
flower$treatment[flower$treatment == "sterilized"] <- "Fungi Absent"
flower$treatment <- as.factor(flower$treatment)
#time to bud graph
first.bud <- flower %>% drop_na(first_bud)
ggplot(first.bud, aes(x = first_bud, fill = type),
position =  position_dodge(width = 0.5)) +
geom_bar(width = 0.5, position = position_dodge(width = 0.5)) +
scale_fill_manual( values=c("#D6A839", "#71A4A0")) +
labs(x = "Time (Week)", y = "First Bud Observered") +
theme_pubr() +
facet_wrap(~treatment)
flower$treatment <- as.character(flower$treatment)
flower$treatment[flower$treatment == "innoculated"] <- "Fungi Present"
flower$treatment[flower$treatment == "sterilized"] <- "Fungi Absent"
flower$treatment <- as.factor(flower$treatment)
#time to bud graph
first.bud <- flower %>% drop_na(first_bud)
ggplot(first.bud, aes(x = first_bud, fill = type),
position =  position_dodge(width = 0.5)) +
geom_bar(width = 0.5, position = position_dodge(width = 0.5)) +
scale_fill_manual( values=c("#D6A839", "#71A4A0")) +
labs(x = "Time (Week)", y = "First Bud Observered") +
theme_pubr() +
facet_wrap(~treatment)
flower$treatment <- as.character(flower$treatment)
flower$treatment[flower$treatment == "innoculated"] <- "Fungi Present"
flower$treatment[flower$treatment == "sterilized"] <- "Fungi Absent"
flower$treatment <- as.factor(flower$treatment)
flower <- read.csv("HPM Growth - Flowering.csv")
str(flower)
flower <- as.data.frame(unclass(flower),stringsAsFactors=TRUE)
flower$treatment <- as.character(flower$treatment)
flower$treatment[flower$treatment == "innoculated"] <- "Fungi Present"
flower$treatment[flower$treatment == "sterilized"] <- "Fungi Absent"
flower$treatment <- as.factor(flower$treatment)
ag.bud <- flower %>%
group_by(treatment, type) %>%
dplyr::summarise(mean= mean(total_bud),
se = sd(total_bud)/sqrt(n()))
bud.graph <- ggplot(ag.bud, aes(x = treatment, y = mean, color = type)) +
geom_errorbar(aes(ymin = mean-se, ymax = mean+se),
position =  position_dodge(width = 0.5), linewidth = 1, width = 0.09) +
geom_point(aes(shape = type), size = 7, position =  position_dodge(width = 0.5)) +
labs(x = "Fungi", y = "Number of flower buds") +
scale_color_manual(values=c("#D6A839", "#71A4A0")) +
scale_shape_manual(values=c(18,18)) +
theme_pubr() +
theme(strip.text = element_text(size = 15),
strip.background = element_blank(),
panel.border = element_rect(fill = "transparent",
color = "gray23", linewidth = 0.12)) +
ylim(0,15)
bud.graph
flower$treatment <- as.character(flower$treatment)
flower$treatment[flower$treatment == "innoculated"] <- "AMF Present"
flower$treatment[flower$treatment == "sterilized"] <- "AMF Absent"
flower$treatment <- as.factor(flower$treatment)
#time to bud graph
first.bud <- flower %>% drop_na(first_bud)
ggplot(first.bud, aes(x = first_bud, fill = type),
position =  position_dodge(width = 0.5)) +
geom_bar(width = 0.5, position = position_dodge(width = 0.5)) +
scale_fill_manual( values=c("#D6A839", "#71A4A0")) +
labs(x = "Time (Week)", y = "First Bud Observered") +
theme_pubr() +
facet_wrap(~treatment)
bud.graph <- ggplot(ag.bud, aes(x = treatment, y = mean, color = type)) +
geom_errorbar(aes(ymin = mean-se, ymax = mean+se),
position =  position_dodge(width = 0.5), linewidth = 1, width = 0.09) +
geom_point(aes(shape = type), size = 7, position =  position_dodge(width = 0.5)) +
labs(x = "Fungi", y = "Number of flower buds") +
scale_color_manual(values=c("#D6A839", "#71A4A0")) +
scale_shape_manual(values=c(18,18)) +
theme_pubr() +
theme(strip.text = element_text(size = 15),
strip.background = element_blank(),
panel.border = element_rect(fill = "transparent",
color = "gray23", linewidth = 0.12)) +
ylim(0,15)
bud.graph
flower$treatment <- as.character(flower$treatment)
flower$treatment[flower$treatment == "innoculated"] <- "AMF"
flower$treatment[flower$treatment == "sterilized"] <- "Control"
flower$treatment <- as.factor(flower$treatment)
ag.bud <- flower %>%
group_by(treatment, type) %>%
dplyr::summarise(mean= mean(total_bud),
se = sd(total_bud)/sqrt(n()))
bud.graph <- ggplot(ag.bud, aes(x = treatment, y = mean, color = type)) +
geom_errorbar(aes(ymin = mean-se, ymax = mean+se),
position =  position_dodge(width = 0.5), linewidth = 1, width = 0.09) +
geom_point(aes(shape = type), size = 7, position =  position_dodge(width = 0.5)) +
labs(x = "Fungi", y = "Number of flower buds") +
scale_color_manual(values=c("#D6A839", "#71A4A0")) +
scale_shape_manual(values=c(18,18)) +
theme_pubr() +
theme(strip.text = element_text(size = 15),
strip.background = element_blank(),
panel.border = element_rect(fill = "transparent",
color = "gray23", linewidth = 0.12)) +
ylim(0,15)
bud.graph
flower <- read.csv("HPM Growth - Flowering.csv")
str(flower)
flower <- as.data.frame(unclass(flower),stringsAsFactors=TRUE)
flower$treatment <- as.character(flower$treatment)
flower$treatment[flower$treatment == "innoculated"] <- "AMF"
flower$treatment[flower$treatment == "sterilized"] <- "Control"
flower$treatment <- as.factor(flower$treatment)
ag.bud <- flower %>%
group_by(treatment, type) %>%
dplyr::summarise(mean= mean(total_bud),
se = sd(total_bud)/sqrt(n()))
bud.graph <- ggplot(ag.bud, aes(x = treatment, y = mean, color = type)) +
geom_errorbar(aes(ymin = mean-se, ymax = mean+se),
position =  position_dodge(width = 0.5), linewidth = 1, width = 0.09) +
geom_point(aes(shape = type), size = 7, position =  position_dodge(width = 0.5)) +
labs(x = "Fungi", y = "Number of flower buds") +
scale_color_manual(values=c("#D6A839", "#71A4A0")) +
scale_shape_manual(values=c(18,18)) +
theme_pubr() +
theme(strip.text = element_text(size = 15),
strip.background = element_blank(),
panel.border = element_rect(fill = "transparent",
color = "gray23", linewidth = 0.12)) +
ylim(0,15)
bud.graph
