emotes::install_version("Matrix", version = "1.6.3")
remotes::install_version("Matrix", version = "1.6.3")
install.packages("lme4", type = "source")  # 1.1.35.1
remotes::install_version("Matrix", version = "1.6.4")
library(lme4)
library(metagear)
#Set the working directory
setwd("/Users/jargrett/Desktop/Castilleja/Data Analysis/RMBL/Observational REU")
#load in packages
library(tidyverse)#for data wrangling and restructuring
library(plyr)#for data wrangling and restructuring
library(glmm)
library(ggplot2)#for plotting
library(ggpubr)#extended functions for plotting
library(car)#for regression analysis
library(emmeans)#post-hoc analysis
library(indicspecies)
library(statmod)
library(rstatix)
#Load in 2023 + 2024 datasets for septentrionalis(For cover analysis)
CASE.24 <- read.csv("Case 2024 Cover.csv")
CASE.23 <- read.csv("Case 2023 Cover.csv")
View(CASE.24)
cali.cover <- read.csv("CALI Species Cover.csv")
View(cali.cover)
#First we subset the data
indv.species = subset(cali.cover, select = -c(2,5,7,8))
View(indv.species)
View(cali.cover)
View(indv.species)
#--------Indicator Species Analysis---------#
case.cover.diversity <- read.csv("Combined septentrionalis Cover Diversity.csv")
cali.cover.diversity <- read.csv("Combined linariifolia Cover Diversity.csv")
#--------Indicator Species Analysis---------#
case.cov <- read.csv("Combined septentrionalis Cover Diversity.csv")
cali.cov <- read.csv("Combined linariifolia Cover Diversity.csv")
View(case.cov)
#--------Indicator Species Analysis---------#
CASE.24 <- read.csv("Case 2024 Cover.csv")
View(CASE.24)
# remove columns that arn't site, plot, treatment
cover = case.cov[,11:ncol(case.cov)]
View(CASE.24)
# remove columns that arn't site, plot, treatment
case.matrix <- CASE.24 %>%
select(Achillea.millefolium:Viola.adunca)
View(case.matrix)
View(CASE.24)
treatment = CASE.24$Treatment
inv = multipatt(case.matrix, treatment, func = "r.g", control = how(nperm=9999))
summary(inv)
case.matrix <- CASE.24 %>%
select(Achillea.millefolium:Viola.adunca) %>%
select (-c(Castilleja.septentrionalis))
treatment = CASE.24$Treatment
inv = multipatt(case.matrix, treatment, func = "r.g", control = how(nperm=9999))
summary(inv)
case.matrix <- CASE.24 %>%
select(11:78) %>%
select (-c(Castilleja.septentrionalis))
treatment = CASE.24$Treatment
inv = multipatt(case.matrix, treatment, func = "r.g", control = how(nperm=9999))
summary(inv)
View(case.matrix)
case.matrix <- CASE.24 %>%
select(11:78) %>%
select (-c(Castilleja.septentrionalis))
case.matrix <- CASE.24 %>%
select(11:78) %>%
select (-c(Castilleja.septentrionalis))
View(case.matrix)
treatment = CASE.24$Site
inv = multipatt(case.matrix, treatment, func = "r.g", control = how(nperm=9999))
summary(inv)
case.matrix <- CASE.24 %>%
select(11:78) %>%
select (-c(Castilleja.septentrionalis)) %>%
filter(Site == "Avery")
case.matrix <- CASE.24 %>%
select(11:78) %>%
select (-c(Castilleja.septentrionalis)) %>%
filter(site == "Avery")
View(CASE.24)
case.matrix <- CASE.24 %>%
filter(site == "Avery") %>%
select(11:78) %>%
select (-c(Castilleja.septentrionalis))
case.matrix <- CASE.24 %>%
filter(CASE.24, site == "Avery") %>%
select(11:78) %>%
select (-c(Castilleja.septentrionalis))
case.matrix <- CASE.24 %>%
filter(site == "Avery") %>%
select(11:78) %>%
select (-c(Castilleja.septentrionalis))
case.matrix <- CASE.24 %>%
filter(Site == "Avery") %>%
select(11:78) %>%
select (-c(Castilleja.septentrionalis))
treatment = CASE.24$Treatment
inv = multipatt(case.matrix, treatment, func = "r.g", control = how(nperm=9999))
inv = multipatt(case.matrix, treatment, func = "r.g", control = how(nperm=9999))
summary(inv)
#Set the working directory
setwd("/Users/jargrett/Desktop/Castilleja/Data Analysis/RMBL/Observational REU")
#load in packages
library(tidyverse)#for data wrangling and restructuring
library(plyr)#for data wrangling and restructuring
library(glmm)
library(ggplot2)#for plotting
library(ggpubr)#extended functions for plotting
library(car)#for regression analysis
library(emmeans)#post-hoc analysis
library(indicspecies)
library(statmod)
library(rstatix)
#--------Indicator Species Analysis---------#
CASE.24 <- read.csv("Case 2024 Cover.csv")
CASE.23 <- read.csv("Case 2023 Cover.csv")
case.matrix <- CASE.24 %>%
filter(Site == "Avery") %>%
select(11:78) %>%
select (-c(Castilleja.septentrionalis))
treatment = CASE.24$Treatment
inv = multipatt(case.matrix, treatment, func = "r.g", control = how(nperm=9999))
# remove columns that arn't site, plot, treatment
case.avery <- filter(CASE.24, Site == "Avery")
View(case.avery)
case.matrix <- case.avery %>%
select(11:78) %>%
select (-c(Castilleja.septentrionalis))
treatment = CASE.24$Treatment
inv = multipatt(case.matrix, treatment, func = "r.g", control = how(nperm=9999))
summary(inv)
View(case.matrix)
treatment = case.avery$Treatment
inv = multipatt(case.matrix, treatment, func = "r.g", control = how(nperm=9999))
summary(inv)
# remove columns that arn't site, plot, treatment
case.avery <- filter(CASE.24, Site == "Avery")
case.matrix <- case.avery %>%
select(11:78)
treatment = case.avery$Treatment
inv = multipatt(case.matrix, treatment, func = "r.g", control = how(nperm=9999))
summary(inv)
# remove columns that arn't site, plot, treatment
case.avery <- filter(CASE.24, Site == "Emerald Lake")
case.matrix <- case.avery %>%
select(11:78) %>%
select (-c(Castilleja.septentrionalis))
treatment = case.avery$Treatment
inv = multipatt(case.matrix, treatment, func = "r.g", control = how(nperm=9999))
summary(inv)
#--------Indicator Species Analysis---------#
CASE.24 <- read.csv("Case 2024 Cover.csv")
CASE.23 <- read.csv("Case 2023 Cover.csv")
CALI.23 <- read.csv("Cali 2023 Cover.csv")
CALI.24 <- read.csv("Cali 2024 Cover.csv")
p
# remove columns that arn't site, plot, treatment
case.avery <- filter(CASE.24, Site == "Copper Creek")
case.matrix <- case.avery %>%
select(11:78) %>%
select (-c(Castilleja.septentrionalis))
treatment = case.avery$Treatment
inv = multipatt(case.matrix, treatment, func = "r.g", control = how(nperm=9999))
summary(inv)
View(CALI.24)
# remove columns that arn't site, plot, treatment
case.avery <- filter(CALI.24, Site == "Deer Creek")
case.matrix <- case.avery %>%
select(11:69) %>%
select (-c(Castilleja.linariifolia))
treatment = case.avery$Treatment
inv = multipatt(case.matrix, treatment, func = "r.g", control = how(nperm=9999))
summary(inv)
# remove columns that arn't site, plot, treatment
case.avery <- filter(CALI.24, Site == "Deer Creek")
View(case.avery)
# remove columns that arn't site, plot, treatment
case.avery <- filter(CALI.24, Site == "Deer Creek 1")
case.matrix <- case.avery %>%
select(11:69) %>%
select (-c(Castilleja.linariifolia))
treatment = case.avery$Treatment
inv = multipatt(case.matrix, treatment, func = "r.g", control = how(nperm=9999))
summary(inv)
# remove columns that arn't site, plot, treatment
case.avery <- filter(CALI.24, Site == "Deer Creek 2")
case.matrix <- case.avery %>%
select(11:69) %>%
select (-c(Castilleja.linariifolia))
treatment = case.avery$Treatment
inv = multipatt(case.matrix, treatment, func = "r.g", control = how(nperm=9999))
summary(inv)
case.matrix <- CALI.24 %>%
select(11:69) %>%
select (-c(Castilleja.linariifolia))
treatment = case.avery$Treatment
inv = multipatt(case.matrix, treatment, func = "r.g", control = how(nperm=9999))
case.matrix <- CALI.24 %>%
select(11:69) %>%
select (-c(Castilleja.linariifolia))
treatment = CALI.24$Treatment
inv = multipatt(CALI.24, treatment, func = "r.g", control = how(nperm=9999))
case.matrix <- CALI.24 %>%
select(11:69) %>%
select (-c(Castilleja.linariifolia))
treatment = CALI.24$Treatment
inv = multipatt(case.matrix, treatment, func = "r.g", control = how(nperm=9999))
summary(inv)
#Set the working directory
setwd("/Users/jargrett/Desktop/Castilleja/Data Analysis/RMBL/Observational REU")
#load in packages
library(tidyverse)#for data wrangling and restructuring
library(plyr)#for data wrangling and restructuring
library(lme4)#for modeling linear mixed effect models
library(nlme)#alternative for modeling linear mixed effect models
library(ggplot2)#for plotting
library(ggpubr)#extended functions for plotting
library(car)#for regression analysis
library(vegan)#for diversity analysis
library(emmeans)#post-hoc analysis
cali.cover <- read.csv("Case Cover 23_24 Combined - Cover.csv")
case.cover <- read.csv("Case Cover 23_24 Combined - Cover.csv")
cali.cover <- read.csv("Cali Cover 23_24 Combined - Cover.csv")
View(cali.cover)
View(cali.cover)
#sperating the species matrix from the environmental data
#also will isolate bareground with the environmental data
cali.env <- subset(cali.cover, select=c(1:3,5:10))
case.env <- subset(case.cover, select=c(1:3,5:10))
View(case.env)
#Isolating the species matric with castilleja included
case.cover.matrix <- case.cover[ -c(1:10)]
cali.cover.matrix <- cali.cover[ -c(1:10)]
View(cali.cover.matrix)
View(case.cover)
View(cali.cover)
#Isolating the species matrix, we also will remove castilleja from the anlaysis to assess the background community
nocase.cover.matrix <- case.cover[ -c(1:10,26)]
nocali.cover.matrix <- cali.cover[ -c(1:10,25)]
View(nocali.cover.matrix)
#linariifolia
cali.cover.div <- diversity(nocali.cover.matrix, index = "shannon")
cali.cover.rich <- specnumber(nocali.cover.matrix)
cali.cover.even <- diversity(nocali.cover.matrix, index = "shannon") / log(specnumber(cali.cover.matrix))
#septentrionalis
case.cover.div <- diversity(nocase.cover.matrix, index = "shannon")
case.cover.rich <- specnumber(nocase.cover.matrix)
case.cover.even <- diversity(nocase.cover.matrix, index = "shannon") / log(specnumber(case.cover.matrix))
#cali
cali.cover.div <- diversity(nocali.cover.matrix, index = "shannon")
cali.cover.rich <- specnumber(nocali.cover.matrix)
cali.cover.even <- diversity(nocali.cover.matrix, index = "shannon") / log(specnumber(cali.cover.matrix))
#case
case.cover.div <- diversity(nocase.cover.matrix, index = "shannon")
case.cover.rich <- specnumber(nocase.cover.matrix)
case.cover.even <- diversity(nocase.cover.matrix, index = "shannon") / log(specnumber(case.cover.matrix))
#Combine calculated values with our environmental data
cali.cover.diversity <- cbind(cali.env,cali.cover.div,cali.cover.rich,cali.cover.even)
case.cover.diversity <- cbind(case.env,case.cover.div,case.cover.rich,case.cover.even)
View(case.cover.diversity)
#renaming columns
case.cover.diversity <- plyr::rename(case.cover.diversity, c("case.cover.div" = "div",
"case.cover.even" = "even",
"case.cover.rich" = "rich",
"Treatment" = "Castilleja"))
cali.cover.diversity <- plyr::rename(cali.cover.diversity, c("cali.cover.div" = "div",
"cali.cover.even" = "even",
"cali.cover.rich" = "rich",
"Treatment" = "Castilleja"))
View(cali.cover.diversity)
#Set the working directory
setwd("/Users/jargrett/Desktop/Castilleja/Data Analysis/RMBL/Observational REU")
#load in packages
library(tidyverse)#for data wrangling and restructuring
library(plyr)#for data wrangling and restructuring
library(lme4)#for modeling linear mixed effect models
library(nlme)#alternative for modeling linear mixed effect models
library(ggplot2)#for plotting
library(ggpubr)#extended functions for plotting
library(car)#for regression analysis
library(emmeans)#post-hoc analysis
#Set the working directory
setwd("/Users/jargrett/Desktop/Castilleja/Data Analysis/RMBL/Observational REU")
#load in relevant packages
library(tidyverse)#for data wrangling and restructuring
library(plyr)#for data wrangling and restructuring
#Import Datasets: We will be using the 23_24 Combined dataset for our analysis
case.cover <- read.csv("Case Cover 23_24 Combined - Cover.csv")
cali.cover <- read.csv("Cali Cover 23_24 Combined - Cover.csv")
#sperating the species matrix from the environmental data
#also will isolate bareground with the environmental data
cali.env <- subset(cali.cover, select=c(1:3,5:10))
case.env <- subset(case.cover, select=c(1:3,5:10))
#Isolating the species matrix, we also will remove Castilleja from the analysis to assess the background community
nocase.cover.matrix <- case.cover[ -c(1:10,26)]
nocali.cover.matrix <- cali.cover[ -c(1:10,25)]
#Isolating the species matric with Castilleja included we will use this to run the secondary analysis
case.cover.matrix <- case.cover[ -c(1:10)]
cali.cover.matrix <- cali.cover[ -c(1:10)]
#--------------------Diversity Analysis--------------------#
library(vegan)#for diversity analysis
#cali
cali.cover.div <- diversity(nocali.cover.matrix, index = "shannon")
cali.cover.rich <- specnumber(nocali.cover.matrix)
cali.cover.even <- diversity(nocali.cover.matrix, index = "shannon") / log(specnumber(cali.cover.matrix))
#case
case.cover.div <- diversity(nocase.cover.matrix, index = "shannon")
case.cover.rich <- specnumber(nocase.cover.matrix)
case.cover.even <- diversity(nocase.cover.matrix, index = "shannon") / log(specnumber(case.cover.matrix))
#Combine calculated values with our environmental data
cali.cover.diversity <- cbind(cali.env,cali.cover.div,cali.cover.rich,cali.cover.even)
case.cover.diversity <- cbind(case.env,case.cover.div,case.cover.rich,case.cover.even)
#renaming columns
case.cover.diversity <- plyr::rename(case.cover.diversity, c("case.cover.div" = "div",
"case.cover.even" = "even",
"case.cover.rich" = "rich"))
cali.cover.diversity <- plyr::rename(cali.cover.diversity, c("cali.cover.div" = "div",
"cali.cover.even" = "even",
"cali.cover.rich" = "rich"))
View(case.cover.diversity)
#creating a new csv for later use and sharing
write.csv(cali.cover.diversity, "/Users/jargrett/Desktop/Castilleja/Data Analysis/RMBL/Observational REU/Combined linariifolia Cover Diversity.csv", row.names=FALSE)
cali.cover.diversity <- read.csv("Combined linariifolia Cover Diversity.csv")
write.csv(case.cover.diversity, "/Users/jargrett/Desktop/Castilleja/Data Analysis/RMBL/Observational REU/Combined septentrionalis Cover Diversity.csv", row.names=FALSE)
case.cover.diversity <- read.csv("Combined septentrionalis Cover Diversity.csv")
#We need to change
str(case.cover.diversity)
case.cover.diversity$site <- as.factor(case.cover.diversity$site)
case.cover.diversity$year <- as.factor(case.cover.diversity$year)
case.cover.diversity$castilleja <- as.factor(case.cover.diversity$castilleja)
case.cover.diversity$pair <- as.factor(case.cover.diversity$pair)
case.cover.diversity$plot <- as.factor(case.cover.diversity$plot)
#Now we can begin by running a linear mixed effect model
#Fixed effects = castilleja and site
#Random effects = year and pair
case.div <- lmer(div ~ castilleja*site + (1|year) + (1|pair), data = case.cover.diversity)
summary(case.div)
Anova(case.div)
emmip(case.div, Castilleja ~ Site)
emmip(case.div, castilleja ~ site)
emmeans(case.div, pairwise ~ castilleja|site)
#Species Richness
case.div <- lmer(rich ~ castilleja*site + (1|year) + (1|pair), data = case.cover.diversity)
summary(case.div)
Anova(case.div) #Castilleja p = 0.02415, Site p =  < 2e-16
emmip(case.div, castilleja ~ site)
emmeans(case.div, pairwise ~ castilleja|site) #Seems that difference is driven by EL
#Species Richness
case.even <- lmer(even ~ castilleja*site + (1|year) + (1|pair), data = case.cover.diversity)
summary(case.even)
Anova(case.even) #Castilleja p = 0.002825, Site p = < 2.2e-16
Anova(case.even) #Castilleja p = 0.0001496, Site p = < < 2.2e-16, insignificant interaction p = 0.0878680
emmip(case.even, castilleja ~ site)
emmeans(case.even, pairwise ~ castilleja|site) #Seems that difference is again driven by EL
emmip(case.rich, castilleja ~ site)
emmip(case.rich, castilleja ~ site)
#Species Richness
case.rich <- lmer(rich ~ castilleja*site + (1|year) + (1|pair), data = case.cover.diversity)
summary(case.rich)
Anova(case.rich) #Castilleja p = 0.002825, Site p = < 2.2e-16
emmip(case.rich, castilleja ~ site)
#Shannon Diverisity
cali.div <- lmer(div ~ castilleja*site + (1|year) + (1|pair), data = cali.cover.diversity)
summary(cali.div)
Anova(cali.div) #Castilleja p = 0.02415, Site p =  < 2e-16
emmip(cali.div, castilleja ~ site)
emmeans(cali.div, pairwise ~ castilleja|site) #Seems that difference is driven by EL
#Species Richness
cali.rich <- lmer(rich ~ castilleja*site + (1|year) + (1|pair), data = cali.cover.diversity)
summary(cali.rich)
Anova(cali.rich) #Castilleja p = 0.002825, Site p = < 2.2e-16
emmip(cali.rich, castilleja ~ site)
emmeans(cali.rich, pairwise ~ castilleja|site) #Seems that difference is again driven by EL
#Species Richness
cali.even <- lmer(even ~ castilleja*site + (1|year) + (1|pair), data = cali.cover.diversity)
summary(cali.even)
Anova(cali.even) #Castilleja p = 0.0001496, Site p = < 2.2e-16, insignificant interaction p = 0.0878680
emmip(cali.even, castilleja ~ site)
emmeans(cali.even, pairwise ~ castilleja|site) #Seems that difference is again driven by Avery control is more even
#Set the working directory
setwd("/Users/jargrett/Desktop/Castilleja/Data Analysis/RMBL/Observational REU")
#load in relevant packages
library(tidyverse)#for data wrangling and restructuring
library(plyr)#for data wrangling and restructuring
#Import Datasets: We will be using the 23_24 Combined dataset for our analysis
case.cover <- read.csv("Case Cover 23_24 Combined - Cover.csv")
cali.cover <- read.csv("Cali Cover 23_24 Combined - Cover.csv")
#sperating the species matrix from the environmental data
#also will isolate bareground with the environmental data
cali.env <- subset(cali.cover, select=c(1:3,5:10))
case.env <- subset(case.cover, select=c(1:3,5:10))
#Isolating the species matrix, we also will remove Castilleja from the analysis to assess the background community
nocase.cover.matrix <- case.cover[ -c(1:10,26)]
nocali.cover.matrix <- cali.cover[ -c(1:10,25)]
#Isolating the species matric with Castilleja included we will use this to run the secondary analysis
case.cover.matrix <- case.cover[ -c(1:10)]
cali.cover.matrix <- cali.cover[ -c(1:10)]
#--------------------Calculating Diversity Values--------------------#
library(vegan)#for diversity analysis
#cali
cali.cover.div <- diversity(nocali.cover.matrix, index = "shannon")
cali.cover.rich <- specnumber(nocali.cover.matrix)
cali.cover.even <- diversity(nocali.cover.matrix, index = "shannon") / log(specnumber(cali.cover.matrix))
#case
case.cover.div <- diversity(nocase.cover.matrix, index = "shannon")
case.cover.rich <- specnumber(nocase.cover.matrix)
case.cover.even <- diversity(nocase.cover.matrix, index = "shannon") / log(specnumber(case.cover.matrix))
#Combine calculated values with our environmental data
cali.cover.diversity <- cbind(cali.env,cali.cover.div,cali.cover.rich,cali.cover.even)
case.cover.diversity <- cbind(case.env,case.cover.div,case.cover.rich,case.cover.even)
#renaming columns
case.cover.diversity <- plyr::rename(case.cover.diversity, c("case.cover.div" = "div",
"case.cover.even" = "even",
"case.cover.rich" = "rich"))
cali.cover.diversity <- plyr::rename(cali.cover.diversity, c("cali.cover.div" = "div",
"cali.cover.even" = "even",
"cali.cover.rich" = "rich"))
#creating a new csv for later use and sharing
write.csv(cali.cover.diversity, "/Users/jargrett/Desktop/Castilleja/Data Analysis/RMBL/Observational REU/Combined linariifolia Cover Diversity.csv", row.names=FALSE)
cali.cover.diversity <- read.csv("Combined linariifolia Cover Diversity.csv")
write.csv(case.cover.diversity, "/Users/jargrett/Desktop/Castilleja/Data Analysis/RMBL/Observational REU/Combined septentrionalis Cover Diversity.csv", row.names=FALSE)
case.cover.diversity <- read.csv("Combined septentrionalis Cover Diversity.csv")
#Lets first check the data structure
str(case.cover.diversity)
case.cover.diversity$site <- as.factor(case.cover.diversity$site)
case.cover.diversity$year <- as.factor(case.cover.diversity$year)
case.cover.diversity$castilleja <- as.factor(case.cover.diversity$castilleja)
case.cover.diversity$pair <- as.factor(case.cover.diversity$pair)
case.cover.diversity$plot <- as.factor(case.cover.diversity$plot)
#Shannon Diverisity
case.div <- lmer(div ~ castilleja*site + (1|year) + (1|pair), data = case.cover.diversity)
summary(case.div)
Anova(case.div) #Castilleja p = 0.02415, Site p =  < 2e-16
emmip(case.div, castilleja ~ site)
emmeans(case.div, pairwise ~ castilleja|site) #Seems that difference is driven by EL
#Species Richness
case.rich <- lmer(rich ~ castilleja*site + (1|year) + (1|pair), data = case.cover.diversity)
