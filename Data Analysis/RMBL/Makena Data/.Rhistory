#setwd
setwd("/Users/jargrett/Desktop/Castilleja/Data Analysis/RMBL/Makena Data")
library(tidyverse) # for data working
library(vegan) # for diversity
library(ggplot2) # plotting
library(ggpubr) # plotting
library(car) # linear regression
library(lme4) # for linear mixed effect model
library(ggpubr)
library(emmeans) # for comparison of means
library(rstatix) # for comparison of means
library(labdsv)
#import files
case <- read.csv("CASE Diversity.csv")
cali <- read.csv("CALI Diversity.csv")
case <- case[ -c(1)]
cali<- cali[ -c(1)]
cali <- cali %>%
rename("div" = "div.cov",
"even" = "even.cov")
#merge dataframes
cd <- rbind(case,cali)
cd <- cd %>%
rename(Castilleja = Treatment)
cd$Castilleja[cd$Castilleja == 'Castilleja'] <- 'Present'
cd$Castilleja[cd$Castilleja == 'Control'] <- 'Absent'
cd <- cd %>%
mutate(species = case_when(
(Site == "Deer Creek 1") ~ "Castilleja linarifolia",
(Site == "Deer Creek 2") ~ "Castilleja linarifolia",
(Site == "Avery") ~ "Castilleja septentrionalis",
(Site == "Emerald Lake") ~ "Castilleja septentrionalis",
))
#Export cd
write.csv(cd, "/Users/jargrett/Desktop/Castilleja/Data Analysis/RMBL/Makena Data/Combined Diversity.csv", row.names=FALSE)
#this is the final master file
cd.pair <- read.csv("Combined Diversity Pair.csv")
#--------------------Models--------------------#
#Analysis for Cali
cali.div <- lmer(div ~ Castilleja*Site + (1|Pair), data=subset(cd.pair, species == "Castilleja linarifolia"))
summary(cali.div)
Anova(cali.div)
cali.rich <- lmer(rich ~ Castilleja*Site + (1|Pair), data=subset(cd.pair, species == "Castilleja linarifolia"))
summary(cali.rich)
Anova(cali.rich)
cali.even <- lmer(even ~ Castilleja*Site + (1|Pair), data=subset(cd.pair, species == "Castilleja linarifolia"))
summary(cali.even)
Anova(cali.even)
#Analysis for Case
case.div <- lmer(div ~ Castilleja*Site + (1|Pair), data=subset(cd.pair, species == "Castilleja septentrionalis"))
summary(case.div)
Anova(case.div)
case.rich <- lmer(rich ~ Castilleja*Site + (1|Pair), data=subset(cd.pair, species == "Castilleja septentrionalis"))
summary(case.rich)
Anova(case.rich)
case.even <- lmer(even ~ Castilleja*Site + (1|Pair), data=subset(cd.pair, species == "Castilleja septentrionalis"))
summary(case.even)
Anova(case.even)
#--------------------graphs--------------------#
#Diversity
cali.div.plot <- ggplot(subset(cd.pair, species %in% "Castilleja linarifolia"), aes(x = Site, y = div, fill = Castilleja)) +
geom_boxplot() +
labs(x = "Population", y = "Shannon Diversity") +
facet_wrap(~species) +
theme_classic2()+
ylim(0,2.5)
cali.div.plot
View(cd.pair)
str(cd.pair)
kt <- cd.pair %>% filter(species=="Castilleja linarifolia") %>%
mutate(population=paste(Site,Castilleja,sep="_"))
View(kt)
cd.pair %>% filter(species=="Castilleja linarifolia") %>%
mutate(population=paste(Site,Castilleja,sep="_")) %>%
ggplot(aes(x=population,y=div,fill=Castilleja)) +
geom_point() +
theme_classic()
?theme
?scale_x_discrete
cd.pair %>% filter(species=="Castilleja linarifolia") %>%
mutate(population=paste(Site,Castilleja,sep="_")) %>%
ggplot(aes(x=population,y=div,fill=Castilleja)) +
geom_point() +
theme_classic() +
scale_x_discrete(breaks=c("Deer Creek 1","Deer Creek 2"))
cd.pair %>% filter(species=="Castilleja linarifolia") %>%
mutate(population=paste(Site,Castilleja,sep="_")) %>%
ggplot(aes(x=population,y=div,fill=Castilleja)) +
geom_point() +
theme_classic() +
scale_x_discrete(limits=c("Deer Creek 1","Deer Creek 2"))
cd.pair %>% filter(species=="Castilleja linarifolia") %>%
mutate(population=paste(Site,Castilleja,sep="_")) %>%
ggplot(aes(x=population,y=div,fill=Castilleja)) +
geom_point() +
theme_classic()
cd_sum <- cd.pair %>% group_by(Site,Castilleja,species) %>%
summarize(mean_div = mean(div),
mean_rich = mean(rich),
mean_even = mean(even))
cd.pair %>% filter(species=="Castilleja linarifolia") %>%
mutate(population=paste(Site,Castilleja,sep="_")) %>%
ggplot(aes(x=population,y=div,fill=Castilleja)) +
geom_point() +
geom_point(data=cd_sum,aes(x=population,x=mean_div),size=3) +
theme_classic()
?stat_summary
cd.pair %>% filter(species=="Castilleja linarifolia") %>%
mutate(population=paste(Site,Castilleja,sep="_")) %>%
ggplot(aes(x=population,y=div,fill=Castilleja)) +
geom_point() +
stat_summary(fun="mean",color="lightblue",size=3,geom="point") +
theme_classic()
cd.pair %>% filter(species=="Castilleja linarifolia") %>%
mutate(population=paste(Site,Castilleja,sep="_")) %>%
ggplot(aes(x=population,y=div,fill=Castilleja)) +
geom_point() +
stat_summary(fun="mean",color="lightblue",size=3,geom="point") +
theme_classic() +
theme(legend.position = "none")
cd.pair %>% filter(species=="Castilleja linarifolia") %>%
mutate(population=paste(Site,Castilleja,sep="_")) %>%
ggplot(aes(x=population,y=div,fill=Castilleja)) +
geom_point() +
stat_summary(fun="mean",color="lightblue",size=8,geom="point") +
theme_classic() +
theme(legend.position = "none")
cd.pair %>% filter(species=="Castilleja linarifolia") %>%
mutate(population=paste(Site,Castilleja,sep="_")) %>%
ggplot(aes(x=population,y=div,fill=Castilleja)) +
geom_point() +
geom_jitter() +
stat_summary(fun="mean",color="lightblue",size=8,geom="point") +
theme_classic() +
theme(legend.position = "none")
cd.pair %>% filter(species=="Castilleja linarifolia") %>%
mutate(population=paste(Site,Castilleja,sep="_")) %>%
ggplot(aes(x=population,y=div,fill=Castilleja)) +
geom_jitter() +
stat_summary(fun="mean",color="lightblue",size=8,geom="point") +
theme_classic() +
theme(legend.position = "none")
cd.pair %>% filter(species=="Castilleja linarifolia") %>%
mutate(population=paste(Site,Castilleja,sep="_")) %>%
ggplot(aes(x=population,y=div,fill=Castilleja)) +
geom_jitter(width = .5) +
stat_summary(fun="mean",color="lightblue",size=8,geom="point") +
theme_classic() +
theme(legend.position = "none")
cd.pair %>% filter(species=="Castilleja linarifolia") %>%
mutate(population=paste(Site,Castilleja,sep="_")) %>%
ggplot(aes(x=population,y=div,fill=Castilleja)) +
geom_jitter(width = 1) +
stat_summary(fun="mean",color="lightblue",size=8,geom="point") +
theme_classic() +
theme(legend.position = "none")
cd.pair %>% filter(species=="Castilleja linarifolia") %>%
mutate(population=paste(Site,Castilleja,sep="_")) %>%
ggplot(aes(x=population,y=div,fill=Castilleja)) +
geom_jitter(width = 0.001) +
stat_summary(fun="mean",color="lightblue",size=8,geom="point") +
theme_classic() +
theme(legend.position = "none")
cd.pair %>% filter(species=="Castilleja linarifolia") %>%
mutate(population=paste(Site,Castilleja,sep="_")) %>%
ggplot(aes(x=population,y=div,fill=Castilleja)) +
geom_jitter(width = 0.01) +
stat_summary(fun="mean",color="lightblue",size=8,geom="point") +
theme_classic() +
theme(legend.position = "none")
cd.pair %>% filter(species=="Castilleja linarifolia") %>%
mutate(population=paste(Site,Castilleja,sep="_")) %>%
ggplot(aes(x=population,y=div,fill=Castilleja)) +
geom_jitter(width = 0.1) +
stat_summary(fun="mean",color="lightblue",size=8,geom="point") +
theme_classic() +
theme(legend.position = "none")
