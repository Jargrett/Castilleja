width = 0.12,
# removing outliers
outlier.color = NA,
alpha = 0.5
) +
stat_dots(
# ploting on left side
side = "left",
# adjusting position
justification = 1.1,
# adjust grouping (binning) of observations
binwidth = 0
) +
# Themes and Labels
scale_fill_tq() +
theme_tq() +
labs(
x = "Engine Size",
y = "Highway Fuel",
fill = "Cylinders"
) +
coord_flip()
ggplot(castilleja.cover, aes(x = castilleja, y = rich, fill = castilleja)) +
# add half-violin from {ggdist} package
stat_halfeye(
# adjust bandwidth
adjust = 0.5,
# move to the right
justification = -0.2,
# remove the slub interval
.width = 0,
point_colour = NA
) +
geom_boxplot(
width = 0.12,
# removing outliers
outlier.color = NA,
alpha = 0.5
) +
stat_dots(
# ploting on left side
side = "left",
# adjusting position
justification = 1.1,
# adjust grouping (binning) of observations
binwidth = 0
) +
# Themes and Labels
scale_fill_tq() +
theme_tq() +
labs(
x = "Engine Size",
y = "Highway Fuel",
fill = "Cylinders"
) +
coord_flip()
install.packages("ggrain")
library(ggrain)
ggplot(castilleja.cover, aes(x = castilleja, y = rich, fill = castilleja)) +
geom_rain(alpha = .5)
ggplot(castilleja.cover, aes(x = 1, y = rich, fill = castilleja)) +
geom_rain(alpha = .5)
ggplot(castilleja.cover, aes(x = 1, y = div, fill = castilleja)) +
geom_rain(alpha = .5)
ggplot(castilleja.cover, aes(x = castilleja, y = div, fill = castilleja)) +
geom_rain(alpha = .5)
ja.cover, aes(x = castilleja, y = div, fill = castilleja)) +
ggplot(castilleja.cover, aes(x = castilleja, y = div, fill = castilleja)) +
geom_rain(alpha = .5) +
facet_wrap(~year)
ggplot(castilleja.cover, aes(year, rich, fill = castilleja)) +
geom_rain(alpha = .6,
cov = "Sepal.Length") +
theme_classic() +
scale_fill_brewer(palette = 'Dark2') +
guides(fill = 'none', color = 'none') +
scale_color_viridis_c(option =  "A", direction = -1)
ggplot(castilleja.cover, aes(year, rich, fill = castilleja)) +
geom_rain(alpha = .6) +
theme_classic() +
scale_fill_brewer(palette = 'Dark2') +
guides(fill = 'none', color = 'none') +
scale_color_viridis_c(option =  "A", direction = -1)
ggplot(castilleja.cover, aes(year, rich, fill = castilleja)) +
geom_rain(alpha = .6) +
theme_classic() +
guides(fill = 'none', color = 'none') +
scale_color_viridis_c(option =  "A", direction = -1)
ggplot(castilleja.cover, aes(year, rich, fill = castilleja)) +
geom_rain(alpha = .6) +
theme_classic() +
scale_fill_brewer(palette = 'Dark2') +
scale_color_viridis_c(option =  "A", direction = -1)
ggplot(castilleja.cover, aes(year, rich, fill = castilleja)) +
geom_rain(alpha = .6) +
theme_classic() +
scale_fill_brewer(palette = 'Dark2') +
guides(fill = 'none', color = 'none') +
scale_color_viridis_c(option =  "A", direction = -1)
ggplot(castilleja.cover, aes(year, rich, fill = castilleja)) +
geom_rain(alpha = .6) +
theme_classic() +
scale_fill_brewer(palette = 'Dark2') +
scale_color_viridis_c(option =  "A", direction = -1)
ggplot(castilleja.cover, aes(year, rich, fill = castilleja)) +
geom_rain(alpha = .6) +
theme_classic() +
scale_fill_brewer(palette = 'Dark2') +
#Productivity Analysis
install.packages("fitdistrplus")
ggplot(castilleja.cover, aes(year, rich, fill = castilleja)) +
geom_rain(alpha = .6) +
theme_classic() +
scale_fill_brewer(palette = 'Dark2') +
#Productivity Analysis
install.packages("fitdistrplus")
ggplot(castilleja.cover, aes(year, rich, fill = castilleja)) +
geom_rain(alpha = .6) +
theme_classic() +
scale_fill_brewer(palette = 'Dark2') +
scale_color_viridis_c(option =  "A", direction = -1)
ggplot(castilleja.cover, aes(year, rich, fill = castilleja)) +
geom_rain(alpha = 1) +
theme_classic() +
scale_fill_brewer(palette = 'Dark2') +
scale_color_viridis_c(option =  "A", direction = -1)
ggplot(castilleja.cover, aes(year, rich, fill = castilleja)) +
geom_rain(alpha = .5) +
theme_classic() +
scale_fill_brewer(palette = 'Dark2') +
scale_color_viridis_c(option =  "A", direction = -1)
ggplot(castilleja.cover, aes(year, rich, fill = castilleja)) +
geom_rain(alpha = .5) +
theme_classic() +
facet_wrap(~year)
ggplot(castilleja.cover, aes(1, rich, fill = castilleja)) +
geom_rain(alpha = .5) +
theme_classic() +
facet_wrap(~year)
ggplot(castilleja.cover, aes(1, rich, fill = castilleja)) +
ggplot(castilleja.cover, aes(1, rich, fill = castilleja)) +
geom_rain(alpha = .5, rain.side = 'l',
boxplot.args = list(color = "black", outlier.shape = NA),
boxplot.args.pos = list(
position = ggpp::position_dodgenudge(x = .1, width = 0.1), width = 0.1
))
ggplot(castilleja.cover, aes(1, rich, fill = castilleja)) +
geom_rain(alpha = .5, rain.side = 'l',
boxplot.args = list(color = "black", outlier.shape = NA),
boxplot.args.pos = list(
position = ggpp::position_dodgenudge(x = .4, width = 0.1), width = 0.1
))
ggplot(castilleja.cover, aes(1, rich, fill = castilleja)) +
geom_rain(alpha = .5, rain.side = 'l',
boxplot.args = list(color = "black", outlier.shape = NA),
boxplot.args.pos = list(
position = ggpp::position_dodgenudge(x = .1, width = 0.1), width = 0.1
))
ggplot(castilleja.cover, aes(1, rich, fill = castilleja)) +
geom_rain(alpha = .5, rain.side = 'l',
boxplot.args = list(color = "black", outlier.shape = NA),
boxplot.args.pos = list(
position = ggpp::position_dodgenudge(x = .1, width = 0.1), width = 0.1
))
ggplot(castilleja.cover, aes(1, rich, fill = castilleja)) +
geom_rain(alpha = .5, rain.side = 'l',
boxplot.args = list(color = "black", outlier.shape = NA),
boxplot.args.pos = list(
position = ggpp::position_dodgenudge(x = .1, width = 0.1), width = 0.1
))
ggplot(castilleja.cover, aes(1, rich, fill = castilleja)) +
geom_rain(alpha = .5, rain.side = 'l',
boxplot.args = list(color = "black", outlier.shape = NA),
boxplot.args.pos = list(
position = ggpp::position_dodgenudge(x = .1, width = 0.1), width = 0.1
)) +
theme_classic() +
facet_wrap(~year) +
scale_fill_brewer(palette = 'Dark2') +
scale_color_viridis_c(option =  "A", direction = -1)
ggplot(castilleja.cover, aes(1, div, fill = castilleja)) +
geom_rain(alpha = .5, rain.side = 'l',
boxplot.args = list(color = "black", outlier.shape = NA),
boxplot.args.pos = list(
position = ggpp::position_dodgenudge(x = .1, width = 0.1), width = 0.1
)) +
theme_classic() +
facet_wrap(~year) +
scale_fill_brewer(palette = 'Dark2') +
scale_color_viridis_c(option =  "A", direction = -1)
ggplot(castilleja.cover, aes(1, div, fill = castilleja, color = castilleja)) +
geom_rain(alpha = .5, rain.side = 'l',
boxplot.args = list(color = "black", outlier.shape = NA),
boxplot.args.pos = list(
position = ggpp::position_dodgenudge(x = .1, width = 0.1), width = 0.1
)) +
theme_classic() +
facet_wrap(~year) +
scale_fill_brewer(palette = 'Dark2') +
scale_color_viridis_c(option =  "A", direction = -1)
ggplot(castilleja.cover, aes(1, div, fill = castilleja, color = species)) +
geom_rain(alpha = .5, rain.side = 'l',
boxplot.args = list(color = "black", outlier.shape = NA),
boxplot.args.pos = list(
position = ggpp::position_dodgenudge(x = .1, width = 0.1), width = 0.1
)) +
theme_classic() +
facet_wrap(~year) +
scale_fill_brewer(palette = 'Dark2') +
scale_color_viridis_c(option =  "A", direction = -1)
ggplot(castilleja.cover, aes(1, div, fill = castilleja, color = species)) +
geom_rain(alpha = .5, rain.side = 'l',
boxplot.args = list(color = "black", outlier.shape = NA),
boxplot.args.pos = list(
position = ggpp::position_dodgenudge(x = .1, width = 0.1), width = 0.1
)) +
theme_classic() +
facet_wrap(~year) +
scale_fill_brewer(palette = 'Dark2') +
scale_color_brewer(palette = 'Dark2') +
guides(fill = 'none', color = 'none')
ggplot(castilleja.cover, aes(1, div, fill = castilleja, color = castilleja)) +
geom_rain(alpha = .5, rain.side = 'l',
boxplot.args = list(color = "black", outlier.shape = NA),
boxplot.args.pos = list(
position = ggpp::position_dodgenudge(x = .1, width = 0.1), width = 0.1
)) +
theme_classic() +
facet_wrap(~year) +
scale_fill_brewer(palette = 'Dark2') +
scale_color_brewer(palette = 'Dark2') +
guides(fill = 'none', color = 'none')
ggplot(castilleja.cover, aes(1, div, fill = castilleja, color = castilleja)) +
geom_rain(alpha = .5, rain.side = 'l',
boxplot.args = list(color = "black", outlier.shape = NA),
boxplot.args.pos = list(
position = ggpp::position_dodgenudge(x = .1, width = 0.2), width = 0.1
)) +
theme_classic() +
facet_wrap(~year) +
scale_fill_brewer(palette = 'Dark2') +
scale_color_brewer(palette = 'Dark2') +
guides(fill = 'none', color = 'none')
ggplot(castilleja.cover, aes(1, div, fill = castilleja, color = castilleja)) +
geom_rain(alpha = .5, rain.side = 'l',
boxplot.args = list(color = "black", outlier.shape = NA),
boxplot.args.pos = list(
position = ggpp::position_dodgenudge(x = .1, width = 0.12), width = 0.1
)) +
theme_classic() +
facet_wrap(~year) +
scale_fill_brewer(palette = 'Dark2') +
scale_color_brewer(palette = 'Dark2') +
guides(fill = 'none', color = 'none')
ggplot(castilleja.cover, aes(1, div, fill = castilleja, color = castilleja)) +
geom_rain(alpha = .5, rain.side = 'l',
boxplot.args = list(color = "black", outlier.shape = NA),
boxplot.args.pos = list(
position = ggpp::position_dodgenudge(x = .1, width = 0.12), width = 0.2
)) +
theme_classic() +
facet_wrap(~year) +
scale_fill_brewer(palette = 'Dark2') +
scale_color_brewer(palette = 'Dark2') +
guides(fill = 'none', color = 'none')
ggplot(castilleja.cover, aes(1, div, fill = castilleja, color = castilleja)) +
geom_rain(alpha = .5, rain.side = 'l',
boxplot.args = list(color = "black", outlier.shape = NA),
boxplot.args.pos = list(
position = ggpp::position_dodgenudge(x = .1, width = 0.12), width = 0.01
)) +
theme_classic() +
facet_wrap(~year) +
scale_fill_brewer(palette = 'Dark2') +
scale_color_brewer(palette = 'Dark2') +
guides(fill = 'none', color = 'none')
ggplot(castilleja.cover, aes(1, div, fill = castilleja, color = castilleja)) +
geom_rain(alpha = .5, rain.side = 'l',
boxplot.args = list(color = "black", outlier.shape = NA),
boxplot.args.pos = list(
position = ggpp::position_dodgenudge(x = .1, width = 0.12), width = 0.09
)) +
theme_classic() +
facet_wrap(~year) +
scale_fill_brewer(palette = 'Dark2') +
scale_color_brewer(palette = 'Dark2') +
guides(fill = 'none', color = 'none')
ggplot(castilleja.cover, aes(1, div, fill = castilleja, color = castilleja)) +
geom_rain(alpha = .5, rain.side = 'l',
boxplot.args = list(color = "black", outlier.shape = NA),
boxplot.args.pos = list(
position = ggpp::position_dodgenudge(x = .1, width = 0.12), width = 0.09
)) +
theme_classic() +
facet_wrap(~year) +
scale_fill_brewer(palette = 'Dark2') +
scale_color_brewer(palette = 'Dark2') +
guides(fill = 'none', color = 'none') +
coord_flip()
ggplot(castilleja.cover, aes(1, div, fill = castilleja, color = castilleja)) +
geom_rain(alpha = .5, rain.side = 'l',
boxplot.args = list(color = "black", outlier.shape = NA),
boxplot.args.pos = list(
position = ggpp::position_dodgenudge(x = .1, width = 0.12), width = 0.09
)) +
theme_classic() +
facet_wrap(~year) +
scale_fill_brewer(palette = 'Dark2') +
scale_color_brewer(palette = 'Dark2') +
guides(fill = 'none', color = 'none') +
coord_flip(1)
ggplot(castilleja.cover, aes(1, div, fill = castilleja, color = castilleja)) +
geom_rain(alpha = .5, rain.side = 'l',
boxplot.args = list(color = "black", outlier.shape = NA),
boxplot.args.pos = list(
position = ggpp::position_dodgenudge(x = .1, width = 0.12), width = 0.09
)) +
theme_classic() +
facet_wrap(~year) +
scale_fill_brewer(palette = 'Dark2') +
scale_color_brewer(palette = 'Dark2') +
guides(fill = 'none', color = 'none') +
coord_flip(2)
ggplot(castilleja.cover, aes(1, div, fill = castilleja, color = castilleja)) +
geom_rain(alpha = .5, rain.side = 'l',
boxplot.args = list(color = "black", outlier.shape = NA),
boxplot.args.pos = list(
position = ggpp::position_dodgenudge(x = .1, width = 0.12), width = 0.09
)) +
theme_classic() +
facet_wrap(~year) +
scale_fill_brewer(palette = 'Dark2') +
scale_color_brewer(palette = 'Dark2') +
guides(fill = 'none', color = 'none')
ggplot(castilleja.cover, aes(1, rich, fill = castilleja, color = castilleja)) +
geom_rain(alpha = .5, rain.side = 'l',
boxplot.args = list(color = "black", outlier.shape = NA),
boxplot.args.pos = list(
position = ggpp::position_dodgenudge(x = .1, width = 0.12), width = 0.09
)) +
theme_classic() +
facet_wrap(~year) +
scale_fill_brewer(palette = 'Dark2') +
scale_color_brewer(palette = 'Dark2') +
guides(fill = 'none', color = 'none')
View(castilleja.cover)
ggplot(castilleja.cover, aes(1, div, fill = castilleja, color = castilleja)) +
geom_rain(alpha = .5, rain.side = 'l',
boxplot.args = list(color = "black", outlier.shape = NA),
boxplot.args.pos = list(
position = ggpp::position_dodgenudge(x = .1, width = 0.12), width = 0.09
)) +
theme_classic() +
facet_wrap(~year) +
scale_fill_brewer(palette = 'Dark2') +
scale_color_brewer(palette = 'Dark2') +
guides(fill = 'none', color = 'none')
ggplot(castilleja.cover, aes(1, div, fill = castilleja, color = castilleja)) +
geom_rain(alpha = .5, rain.side = 'l',
boxplot.args = list(color = "black", outlier.shape = NA),
boxplot.args.pos = list(
position = ggpp::position_dodgenudge(x = .1, width = 0.12), width = 0.09
)) +
theme_classic() +
facet_wrap(~year) +
scale_fill_brewer(palette = 'Dark2') +
scale_color_brewer(palette = 'Dark2') +
guides(fill = 'none', color = 'none') +
geom_jitter()
ggplot(castilleja.cover, aes(1, div, fill = castilleja, color = castilleja)) +
geom_rain(alpha = .5, rain.side = 'l',
boxplot.args = list(color = "black", outlier.shape = NA),
boxplot.args.pos = list(
position = ggpp::position_dodgenudge(x = .1, width = 0.12), width = 0.09
)) +
theme_classic() +
facet_wrap(~year) +
scale_fill_brewer(palette = 'Dark2') +
scale_color_brewer(palette = 'Dark2') +
guides(fill = 'none', color = 'none')
over.lm <- lm(mass_remaining ~ removal*litter + deployment_period, data = decomp)
summary(over.lm)
Anova(over.lm)
emmip(over.lm, litter ~ deployment_period)
setwd("/Users/jargrett/Desktop/Castilleja/Data Analysis/RMBL/2024 Argrett")
library(litterfitter)#for k-curve fitting
library(tidyverse)#for data wrangling and restructuring
library(dplyr)#for data wrangling and restructuring
library(lme4)#for modeling linear mixed effect models
library(nlme)#alternative for modeling linear mixed effect models
library(ggplot2)#for plotting
library(ggpubr)#extended functions for plotting
library(car)#for regression analysis
library(emmeans)#post-hoc analysis
library(dplyr)
library(plyr)
#load-in the data
winter <- read.csv("Litter Decomposition - 2023-2024 Overwinter.csv")
within <- read.csv("Litter Decomposition - 2024 Within Season.csv")
yearlong <- read.csv("Litter Decomposition - 2023-2024 Full Year.csv")
#yearlong <- read.csv("Litter Decomposition - 2023-2024 Yearlong.csv")
#bind
decomp <- rbind.fill(winter, within, yearlong)
#check structure
str(decomp)
decomp <- as.data.frame(unclass(decomp),stringsAsFactors=TRUE)
within <- as.data.frame(unclass(within),stringsAsFactors=TRUE)
winter <- as.data.frame(unclass(winter),stringsAsFactors=TRUE)
yearlong <- as.data.frame(unclass(yearlong),stringsAsFactors=TRUE)
#yearlong <- as.data.frame(unclass(yearlong),stringsAsFactors=TRUE)
#remove missing bags
decomp <- decomp %>%
filter(missing != "Yes") %>%
dplyr::select(-c((missing)))
within <- within %>%
filter(missing != "Yes") %>%
dplyr::select(-c((missing)))
winter <- winter %>%
filter(missing != "Yes") %>%
dplyr::select(-c((missing)))
yearlong <- yearlong %>%
filter(missing != "Yes") %>%
dplyr::select(-c((missing)))
decomp <- decomp %>% mutate(mass_remaining = final_dry_weight/initial_dry_weight)
within <- within %>% mutate(mass_remaining = final_dry_weight/initial_dry_weight)
winter <- winter %>% mutate(mass_remaining = final_dry_weight/initial_dry_weight)
yearlong <- yearlong %>% mutate(mass_remaining = final_dry_weight/initial_dry_weight)
decomp <- decomp %>% mutate(time = deployment_duration/365)
within <- within %>% mutate(time = deployment_duration/365)
winter <- winter %>% mutate(time = deployment_duration/365)
yearlong <- yearlong %>% mutate(time = deployment_duration/365)
#Removing Outliers for testing
decomp <- decomp[-c(57,69,157),]
over.lm <- lm(mass_remaining ~ removal*litter + deployment_period, data = decomp)
summary(over.lm)
Anova(over.lm)
emmip(over.lm, litter ~ deployment_period)
emmeans(over.lm, pairwise ~ litter|deployment_period)
litter <- fit_litter(time = decomp$time,
mass.remaining = decomp$mass_remaining,
model = "weibull",
iters=1000)
plot_multiple_fits(time = decomp$time,
mass.remaining = decomp$mass_remaining,
model=c("neg.exp","weibull"),
iters=500)
summary(litter)
class(litter)
plot(litter)
boxplot(decomp$mass_remaining ~ decomp$litter)
ggplot(decomp, aes(x = litter, y = mass_remaining)) +
geom_jitter(aes(color = (litter))) +
facet_wrap(~deployment_period) +
labs(x = "Litter Treatment", y = "Mass remaining")
over.lm <- lm(mass_remaining ~ removal*litter + deployment_period, data = decomp)
summary(over.lm)
Anova(over.lm)
emmip(over.lm, litter ~ deployment_period)
emmeans(over.lm, pairwise ~ litter|deployment_period)
#Belowground Analysis
setwd("/Users/jargrett/Desktop/Castilleja/Data Analysis/RMBL/2024 Argrett")
library(tidyverse)#for data wrangling and restructuring
library(plyr)#for data wrangling and restructuring
library(ggplot2)#for plotting
library(ggpubr)#extended functions for plotting
library(car)#for regression analysis
library(emmeans)#post-hoc analysis
library(lme4)#for modeling linear mixed effect models
library(GGally)#this is new
library(factoextra)#this is new
soil <- read.csv("Soil Nutrients - Full.csv")
soil <- as.data.frame(unclass(soil),stringsAsFactors=TRUE)
soil <- plyr::rename(soil, c("nitrate" = "NO3",
"ammonium" = "NH4"))
nitrate <- ggplot(soil, aes(x = litter, y = K)) +
geom_point(aes(color = (removal))) +
facet_wrap(~burial) +
labs(x = "Litter Treatment", y = "K")
nitrate
K.lmm <- lmer(K ~ litter*removal + burial + (1|block) + (1|pair), data = soil)
summary(K.lmm)
Anova(K.lmm)
emmip(K.lmm, litter ~ removal)
emmeans(K.lmm, pairwise ~  removal|litter)
#remove rows if NAs occur in any of the variables we care about
winter.soil <- subset(soil, burial == 'overwinter')
winter.soil <- subset( winter.soil, select = -c(B, S, Pb, Al, Cd))
winter.soil <- winter.soil %>% filter_at(vars(NO3, NH4, Ca, Mg, K, P, Fe, Mn, Cu, Zn),
all_vars(!is.na(.)))
#Examine correlations among the body shape response variables------
#ggpairs plots is a good way to get lots of info (GGally package)
ggpairs(winter.soil, mapping = aes(color = litter),
columns = c("NO3", "NH4",
"K", "P"))+
scale_colour_manual(values = c("coral4","darkolivegreen3","deepskyblue4","darkgoldenrod2")) +
scale_fill_manual(values = c("coral4","darkolivegreen3","deepskyblue4","darkgoldenrod2"))
#PCA analysis--------------------
winter.pca <- prcomp (~ NO3 + NH4 + Ca + Mg + K + P + Fe + Mn + Cu + Zn,
data=winter.soil,
scale. = TRUE) #Make sure to scale variables!
#Get factor loadings on principle components
winter.pca
#Visualize how much variation is explained by each principle component (Scree plot)
#Basic plot
plot(winter.pca)#however, this gives us the absolute variances, not % of total variance
#Use function from a different package (factoextra) for nicer plot
fviz_eig(winter.pca,addlabels = TRUE)
#Visualize results in a biplot--------
fviz_pca_biplot(winter.pca, label = "var",
col.ind = winter.soil$litter, palette = c("coral4","darkolivegreen3","deepskyblue4","darkgoldenrod2"),
col.var = "black", repel = TRUE,
legend.title = "Litter")
