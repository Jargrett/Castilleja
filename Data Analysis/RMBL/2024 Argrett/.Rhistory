plot(year.pca)#however, this gives us the absolute variances, not % of total variance
#Use function from a different package (factoextra) for nicer plot
fviz_eig(year.pca,addlabels = TRUE)
#Visualize results in a biplot--------
fviz_pca_biplot(year.pca, label = "var",
col.ind = winter.soil$litter, palette = c("coral4","darkgoldenrod2","deepskyblue4","darkolivegreen3"),
col.var = "black", repel = TRUE,
legend.title = "Litter Treatment")
View(year.pca)
#Visualize results in a biplot--------
fviz_pca_biplot(year.pca, label = "var",
col.ind = year.soil$litter, palette = c("coral4","darkgoldenrod2","deepskyblue4","darkolivegreen3"),
col.var = "black", repel = TRUE,
legend.title = "Litter Treatment")
perm <- adonis2(year.pca ~ litter*removal, data = NMDS, permutations=9999)
perm
ggplot(data = nutrients.bind, aes(x = litter, y = Comp.1)) +
geom_boxplot() +
geom_jitter(aes(colour = litter), width = 0.3, height = 0) +
theme_bw()
#-------#
adonis2(nutrients.bind$Comp.2 ~ litter*removal,
data = nutrients.bind,
method = "euc",
permutations=9999)
#-------#
adonis2(nutrients.bind$Comp.3 ~ litter*removal,
data = nutrients.bind,
method = "euc",
permutations=9999)
ggplot(data = nutrients.bind, aes(x = litter, y = Comp.2)) +
geom_boxplot() +
geom_jitter(aes(colour = litter), width = 0.3, height = 0) +
theme_bw()
ggplot(data = nutrients.bind, aes(x = litter, y = Comp.3)) +
geom_boxplot() +
geom_jitter(aes(colour = litter), width = 0.3, height = 0) +
theme_bw()
View(soil)
K.lmm <- lmer(NO3 ~ litter*removal + burial + (1|block) + (1|pair), data = soil)
summary(K.lmm)
Anova(K.lmm)
emmip(K.lmm, litter ~ removal)
K.lmm <- lmer(NO3 ~ litter*removal*burial + (1|block) + (1|pair), data = soil)
summary(K.lmm)
Anova(K.lmm)
emmip(K.lmm, litter ~ removal)
emmeans(K.lmm, pairwise ~  removal|litter)
emmip(K.lmm, litter ~ removal)
K.lmm <- lmer(NO3 ~ litter*removal*burial + (1|block) + (1|pair), data = soil)
summary(K.lmm)
Anova(K.lmm)
K.lmm <- lmer(K ~ litter*removal*burial + (1|block) + (1|pair), data = soil)
summary(K.lmm)
Anova(K.lmm)
emmip(K.lmm, litter ~ removal)
emmeans(K.lmm, pairwise ~  removal|litter)
emmip(K.lmm, litter ~ removal)
K.lmm <- lmer(NH4 ~ litter*removal*burial + (1|block) + (1|pair), data = soil)
summary(K.lmm)
Anova(K.lmm)
emmip(K.lmm, litter ~ removal)
setwd("/Users/jargrett/Desktop/Castilleja/Data Analysis/RMBL/2024 Argrett")
library(litterfitter)#for k-curve fitting
library(tidyverse)#for data wrangling and restructuring
library(dplyr)#for data wrangling and restructuring
library(lme4)#for modeling linear mixed effect models
library(nlme)#alternative for modeling linear mixed effect models
library(ggplot2)#for plotting
library(ggpubr)#extended functions for plotting
library(car)#for regression analysis
library(emmeans)#post-hoc analysis
library(dplyr)
library(plyr)
#load-in the data
winter <- read.csv("Litter Decomposition - 2023-2024 Overwinter.csv")
within <- read.csv("Litter Decomposition - 2024 Within Season.csv")
yearlong <- read.csv("Litter Decomposition - 2023-2024 Full Year.csv")
#yearlong <- read.csv("Litter Decomposition - 2023-2024 Yearlong.csv")
#bind
decomp <- rbind.fill(winter, within, yearlong)
#check structure
str(decomp)
decomp <- as.data.frame(unclass(decomp),stringsAsFactors=TRUE)
within <- as.data.frame(unclass(within),stringsAsFactors=TRUE)
winter <- as.data.frame(unclass(winter),stringsAsFactors=TRUE)
yearlong <- as.data.frame(unclass(yearlong),stringsAsFactors=TRUE)
#yearlong <- as.data.frame(unclass(yearlong),stringsAsFactors=TRUE)
#remove missing bags
decomp <- decomp %>%
filter(missing != "Yes") %>%
dplyr::select(-c((missing)))
within <- within %>%
filter(missing != "Yes") %>%
dplyr::select(-c((missing)))
winter <- winter %>%
filter(missing != "Yes") %>%
dplyr::select(-c((missing)))
yearlong <- yearlong %>%
filter(missing != "Yes") %>%
dplyr::select(-c((missing)))
decomp <- decomp %>% mutate(mass_remaining = final_dry_weight/initial_dry_weight)
within <- within %>% mutate(mass_remaining = final_dry_weight/initial_dry_weight)
winter <- winter %>% mutate(mass_remaining = final_dry_weight/initial_dry_weight)
yearlong <- yearlong %>% mutate(mass_remaining = final_dry_weight/initial_dry_weight)
decomp <- decomp %>% mutate(time = deployment_duration/365)
within <- within %>% mutate(time = deployment_duration/365)
winter <- winter %>% mutate(time = deployment_duration/365)
yearlong <- yearlong %>% mutate(time = deployment_duration/365)
#Removing Outliers for testing
decomp <- decomp[-c(57,69,157),]
over.lm <- lmer(mass_remaining ~ removal*litter + deployment_period + (1|location), data = decomp)
summary(over.lm)
Anova(over.lm)
emmip(over.lm, litter ~ deployment_period)
emmeans(over.lm, pairwise ~ litter|deployment_period)
litter <- fit_litter(time = decomp$time,
mass.remaining = decomp$mass_remaining,
model = "weibull",
iters=1000)
plot_multiple_fits(time = decomp$time,
mass.remaining = decomp$mass_remaining,
model=c("neg.exp","weibull"),
iters=500)
summary(litter)
class(litter)
plot(litter)
boxplot(decomp$mass_remaining ~ decomp$litter)
#Standard error calculations
decomp.mean <- decomp %>%
group_by(deployment_period, litter) %>%
dplyr::summarise(mean= mean(mass_remaining),
se = sd(mass_remaining)/sqrt(n()))
decomp.plot <- ggplot(data = decomp.mean, aes(x = reorder (deployment_period, -mean), y = mean, color = litter)) +
geom_point(shape=18, size = 4) +
geom_errorbar(aes(ymin = mean-se, ymax = mean+se),
position =  position_dodge(width = 0.5), width = 0.07) +
theme_pubr() +
facet_wrap(~litter) +
scale_color_manual( values=c("#004D40", "#C52812", "#FFC107")) +
theme(strip.text = element_text(size = 15),
strip.background = element_blank(),
panel.border = element_rect(fill = "transparent",
color = "gray", linewidth = 0.12)) +
labs(x = "Deployment Period", y = "Proportion of Mass Remaining") +
ylim(0,1)
decomp.plot
full.decomp.plot <- ggplot(data = decomp.mean, aes(x = reorder (deployment_period, -mean), y = mean, color = litter)) +
geom_point(shape=18, size = 4,position =  position_dodge(width = 0.5)) +
geom_errorbar(aes(ymin = mean-se, ymax = mean+se),
position =  position_dodge(width = 0.5), width = 0.07) +
theme_pubr() +
scale_color_manual( values=c("#004D40", "#C52812", "#FFC107")) +
theme(strip.text = element_text(size = 15),
strip.background = element_blank(),
panel.border = element_rect(fill = "transparent",
color = "gray", linewidth = 0.12)) +
labs(x = "Deployment Period", y = "Proportion of Mass Remaining") +
ylim(0.25 ,0.75)
full.decomp.plot
decomp.plot <- ggplot(data = decomp.mean, aes(x = reorder (deployment_period, -mean), y = mean, color = litter)) +
geom_point(shape=18, size = 4) +
geom_errorbar(aes(ymin = mean-se, ymax = mean+se),
position =  position_dodge(width = 0.5), width = 0.07) +
theme_pubr() +
facet_wrap(~litter) +
scale_color_manual( values=c("#004D40", "#C52812", "#FFC107")) +
theme(strip.text = element_text(size = 15),
strip.background = element_blank(),
panel.border = element_rect(fill = "transparent",
color = "gray", linewidth = 0.12)) +
labs(x = "Deployment Period", y = "Proportion of Mass Remaining") +
ylim(0,1)
decomp.plot
View(decomp)
K.lmm <- lmer(NH4 ~ litter*removal*burial + (1|block) + (1|pair), data = soil)
summary(K.lmm)
Anova(K.lmm)
View(soil)
nutrient.plot <- ggplot(data = year.soil, aes(x = litter, y = NO3, fill = litter)) +
geom_col(position = "dodge", width = .7, linewidth = 0.5, alpha = 0.5, color = "black", size = 0.1) +
geom_errorbar(aes(ymin = mean-se, ymax = mean+se),
position =  position_dodge(width = 0.5), width = 0.15) +
theme_pubr() +
scale_fill_manual(values=c("indianred3", "burlywood4")) +
labs(x = "Litter bag", y = "NO3 (micro grams/10cm2/burial length)") +
ylim(0,1)
nutrient.plot <- ggplot(data = year.soil, aes(x = litter, y = NO3, fill = litter)) +
geom_col(position = "dodge", width = .7, linewidth = 0.5, alpha = 0.5, color = "black") +
geom_errorbar(aes(ymin = mean-se, ymax = mean+se),
position =  position_dodge(width = 0.5), width = 0.15) +
theme_pubr() +
scale_fill_manual(values=c("indianred3", "burlywood4")) +
labs(x = "Litter bag", y = "NO3 (micro grams/10cm2/burial length)") +
ylim(0,1)
nutrient.plot
nutrient.plot <- ggplot(data = year.soil, aes(x = litter, y = NO3, fill = litter)) +
geom_col(position = "dodge", width = .7, linewidth = 0.5, alpha = 0.5, color = "black") +
theme_pubr() +
scale_fill_manual(values=c("indianred3", "burlywood4")) +
labs(x = "Litter bag", y = "NO3 (micro grams/10cm2/burial length)") +
ylim(0,1)
nutrient.plot
nutrient.plot <- ggplot(data = year.soil, aes(x = litter, y = NO3, fill = removal)) +
geom_col(position = "dodge", width = .7, linewidth = 0.5, alpha = 0.5, color = "black") +
theme_pubr() +
scale_fill_manual(values=c("indianred3", "burlywood4")) +
facet_wrap(~litter)
nutrient.plot <- ggplot(data = year.soil, aes(x = litter, y = NO3, fill = removal)) +
geom_col(position = "dodge", width = .7, linewidth = 0.5, alpha = 0.5, color = "black") +
theme_pubr() +
scale_fill_manual(values=c("indianred3", "burlywood4")) +
facet_wrap(~litter) +
labs(x = "Litter bag", y = "NO3 (micro grams/10cm2/burial length)") +
ylim(0,1)
nutrient.plot
nutrient.plot <- ggplot(data = year.soil, aes(x = litter, y = NO3, fill = removal)) +
geom_col(position = "dodge", width = .7, linewidth = 0.5, alpha = 0.5, color = "black") +
theme_pubr() +
scale_fill_manual(values=c("indianred3", "burlywood4")) +
facet_wrap(~litter) +
labs(x = "Litter bag", y = "NO3 (micro grams/10cm2/burial length)") +
ylim(0,700)
nutrient.plot
nutrient.plot <- ggplot(data = year.soil, aes(x = litter, y = NO3, fill = removal)) +
geom_col(position = "dodge", width = .7, linewidth = 0.5, alpha = 0.5, color = "black") +
theme_pubr() +
scale_fill_manual(values=c("indianred3", "burlywood4")) +
labs(x = "Litter bag", y = "NO3 (micro grams/10cm2/burial length)") +
ylim(0,700)
nutrient.plot
yearlong.NO3 <- year.soil %>%
group_by(litter,removal) %>%
dplyr::summarise(mean= mean(NO3),
se = sd(NO3)/sqrt(n()))
View(yearlong.NO3)
View(yearlong.NO3)
#Belowground Analysis
setwd("/Users/jargrett/Desktop/Castilleja/Data Analysis/RMBL/2024 Argrett")
library(tidyverse)#for data wrangling and restructuring
library(plyr)#for data wrangling and restructuring
library(ggplot2)#for plotting
library(ggpubr)#extended functions for plotting
library(car)#for regression analysis
library(emmeans)#post-hoc analysis
library(lme4)#for modeling linear mixed effect models
library(GGally)#this is new
library(factoextra)#this is new
soil <- read.csv("Soil Nutrients - Full.csv")
soil <- as.data.frame(unclass(soil),stringsAsFactors=TRUE)
soil <- plyr::rename(soil, c("nitrate" = "NO3",
"ammonium" = "NH4"))
nitrate <- ggplot(soil, aes(x = litter, y = K)) +
geom_point(aes(color = (removal))) +
facet_wrap(~burial) +
labs(x = "Litter Treatment", y = "K")
nitrate
K.lmm <- lmer(NH4 ~ litter*removal*burial + (1|block) + (1|pair), data = soil)
summary(K.lmm)
Anova(K.lmm)
emmip(K.lmm, litter ~ removal)
NO3.plot <- ggplot(data = yearlong.NO3, aes(x = litter, y = mean, pattern = removal)) +
scale_pattern_manual(values = c( R = "stripe", C = "none")) +
#remove rows if NAs occur in any of the variables we care about
winter.soil <- subset(soil, burial == 'overwinter')
winter.soil <- subset( winter.soil, select = -c(B, S, Pb, Al, Cd))
year.soil <- year.soil %>% filter_at(vars(NO3, NH4, Ca, Mg, K, P, Fe, Mn, Cu, Zn),
all_vars(!is.na(.)))
#Examine correlations among the body shape response variables------
#ggpairs plots is a good way to get lots of info (GGally package)
ggpairs(year.soil, mapping = aes(color = litter),
columns = c("NO3", "NH4",
"K", "P"))+
scale_colour_manual(values = c("coral4","darkolivegreen3","deepskyblue4","darkgoldenrod2")) +
scale_fill_manual(values = c("coral4","darkolivegreen3","deepskyblue4","darkgoldenrod2"))
#PCA analysis--------------------
year.pca <- prcomp (~ NO3 + NH4 + Ca + Mg + K + P + Fe + Mn + Cu + Zn,
data=year.soil,
scale. = TRUE) #Make sure to scale variables!
#Get factor loadings on principle components
year.pca
#Visualize how much variation is explained by each principle component (Scree plot)
#Basic plot
plot(year.pca)#however, this gives us the absolute variances, not % of total variance
#Use function from a different package (factoextra) for nicer plot
fviz_eig(year.pca,addlabels = TRUE)
#Visualize results in a biplot--------
fviz_pca_biplot(year.pca, label = "var",
col.ind = year.soil$litter, palette = c("coral4","darkgoldenrod2","deepskyblue4","darkolivegreen3"),
col.var = "black", repel = TRUE,
legend.title = "Litter Treatment")
perm <- adonis2(year.pca ~ litter*removal, data = NMDS, permutations=9999)
perm
#-------PCA Analysis-------#
library(stats)
library(vegan)
library(tidyverse)
library(ggbiplot)
library(GGally)#this is new
library(factoextra)#this is new
#Create an object that contains the response variables (Nutrients)
# Units: (micro grams/10cm2/burial length)
year.soil <- subset(soil, burial == 'year')
year.soil <- subset( year.soil, select = -c(B, S, Pb, Al, Cd))
nutrients <- subset(year.soil, select = c(NO3, NH4, Ca, Mg, K, P, Fe, Mn, Cu, Zn))
#subset out predictors
envi <- subset(soil, select = c(5:10))
#Normalize data – subtract the mean and divide by the standard deviation for each column.
nutrients.scale <- scale(nutrients)
#Convert raw data to correlation matrix
nutrients.matrix <- cov(nutrients.scale)
nutrients.matrix %>% round(2)
#Conduct eigenanalysis
nutrients.eigen <- eigen(nutrients.matrix)
#There will be 10 eigenvalues (equal to number of response variables)
nutrients.eigen$values %>% round(3)
#The eigenvalues sum to the total of the diagonal of the matrix analyzed
sum(nutrients.eigen$values)
#Express eigenvalues as a proportion of the total amount of variation
nutrients.eigen.prop <- nutrients.eigen$values / sum(nutrients.eigen$values)
nutrients.eigen.prop %>% round(3)
#visualize eigenvectors
#rows correspond to the original variables
#columns correspond to the principal component identified by each eigenvalue.
nutrients.eigen$vectors %>% round(2)
#loadings are the coefficients of the linear equation that ‘blend’ the variables together for that principal component.
loadings <- nutrients.eigen$vectors[ , 1:3] %>%
data.frame(row.names = colnames(nutrients)) %>%
dplyr::rename("PC1" = X1, "PC2" = X2, "PC3" = X3) %>%
round(digits = 3)
loadings
#Interpret the Scores of Sample Units
pc.scores <- nutrients.scale %*% nutrients.eigen$vectors
pc.scores %>% head()
#The PC scores are orthogonal to (i.e., uncorrelated with) each other
cor(pc.scores) %>% round(3)
nutrients.pca <- princomp(nutrients.scale, cor = TRUE)
scores <- nutrients.pca$scores
nutrients.bind <- cbind(envi,scores)
summary(nutrients.pca, loadings = TRUE, cutoff = 0)
fviz_eig(nutrients.pca,addlabels = TRUE)
#-------#
adonis2(nutrients.bind$Comp.3 ~ litter*removal,
data = nutrients.bind,
method = "euc",
permutations=9999)
ggplot(data = nutrients.bind, aes(x = litter, y = Comp.3)) +
geom_boxplot() +
geom_jitter(aes(colour = litter), width = 0.3, height = 0) +
theme_bw()
K.lmm <- lmer(NH4 ~ litter*removal + (1|block) + (1|pair), data = year.soil)
summary(K.lmm)
Anova(K.lmm)
soil <- plyr::rename(soil, c("nitrate" = "NO3",
"ammonium" = "NH4"))
K.lmm <- lmer(NO3 ~ litter*removal + (1|block) + (1|pair), data = year.soil)
summary(K.lmm)
Anova(K.lmm)
Anova(K.lmm)
emmip(K.lmm, litter ~ removal)
emmeans(K.lmm, pairwise ~  removal|litter)
View(year.soil)
yearlong.NO3 <- year.soil %>%
group_by(litter,removal) %>%
dplyr::summarise(mean= mean(NO3),
se = sd(NO3)/sqrt(n()))
View(soil)
K.lmm <- lmer(NO3 ~ litter*removal + (1|block) + (1|pair), data = soil)
summary(K.lmm)
Anova(K.lmm)
emmip(K.lmm, litter ~ removal)
emmeans(K.lmm, pairwise ~  removal|litter)
K.lmm <- lmer(NO3 ~ litter*removal*deployment_period + (1|block) + (1|pair), data = soil)
summary(K.lmm)
Anova(K.lmm)
emmip(K.lmm, litter ~ removal)
emmeans(K.lmm, pairwise ~  removal|litter)
K.lmm <- lmer(K ~ litter*removal*deployment_period + (1|block) + (1|pair), data = soil)
summary(K.lmm)
Anova(K.lmm)
emmip(K.lmm, litter ~ removal)
K.lmm <- lmer(K ~ litter*removal + deployment_period + (1|block) + (1|pair), data = soil)
summary(K.lmm)
Anova(K.lmm)
K.lmm <- lmer(K ~ litter*removal + deployment_period + (1|block) + (1|pair), data = soil)
View(soil)
K.lmm <- lmer(K ~ litter*removal*burial + (1|block) + (1|pair), data = soil)
summary(K.lmm)
Anova(K.lmm)
emmip(K.lmm, litter ~ removal)
K.lmm <- lmer(K ~ litter*removal + burial + (1|block) + (1|pair), data = soil)
summary(K.lmm)
Anova(K.lmm)
emmip(K.lmm, litter ~ removal)
emmeans(K.lmm, pairwise ~  removal|litter)
K.lmm <- lmer(NO3 ~ litter*removal + burial + (1|block) + (1|pair), data = soil)
summary(K.lmm)
Anova(K.lmm)
emmip(K.lmm, litter ~ removal)
emmeans(K.lmm, pairwise ~  removal|litter)
yearlong.NO3 <- year.soil %>%
group_by(litter,removal) %>%
dplyr::summarise(mean= mean(NO3),
se = sd(NO3)/sqrt(n()))
K.lmm <- lmer(NO3 ~ litter*removal + burial + (1|block) + (1|pair), data = soil)
summary(K.lmm)
Anova(K.lmm)
emmip(K.lmm, litter ~ removal)
emmeans(K.lmm, pairwise ~  removal|litter)
yearlong.NO3 <- year.soil %>%
group_by(litter,removal,burial) %>%
dplyr::summarise(mean= mean(NO3),
se = sd(NO3)/sqrt(n()))
View(yearlong.NO3)
soil.NO3 <- soil %>%
group_by(litter,removal,burial) %>%
dplyr::summarise(mean= mean(NO3),
se = sd(NO3)/sqrt(n()))
NO3.plot <- ggplot(data = yearlong.NO3, aes(x = litter, y = mean, pattern = removal)) +
#remove rows if NAs occur in any of the variables we care about
winter.soil <- subset(soil, burial == 'overwinter')
soil.NO3 <- soil %>%
group_by(litter,removal,burial) %>%
dplyr::summarise(mean= mean(NO3),
se = sd(NO3)/sqrt(n()))
K.lmm <- lmer(NO3 ~ litter*removal + burial + (1|block) + (1|pair), data = soil)
summary(K.lmm)
Anova(K.lmm)
emmip(K.lmm, litter ~ removal)
emmeans(K.lmm, pairwise ~  removal|litter)
Anova(K.lmm)
library(ggpattern)
install.packages("ggpattern")
library(ggpattern)
NO3.plot <- ggplot(data = soil.NO3, aes(x = litter, y = mean, pattern = removal)) +
geom_bar(stat="identity", color="black",position=position_dodge2(preserve="single", padding=0), alpha=0.5) +
geom_errorbar(aes(ymin=mean, ymax=mean+se), alpha=1, width=.2,position=position_dodge(.9)) +
theme(panel.grid = element_blank(),legend.position = "bottom") +
labs(x="Litter Type", y="Nitrate (micro grams/10cm2/burial length)", pattern="") + scale_fill_manual(values=cols)+
geom_bar_pattern(stat="identity", position = "dodge", color = "black", pattern_angle = 45, pattern_density = 0.1, pattern_spacing = 0.025, pattern_key_scale_factor = 0.6) +
facet_grid(~ burial, scales = "free")
NO3.plot
NO3.plot <- ggplot(data = soil.NO3, aes(x = litter, y = mean, color = removal, pattern = removal)) +
geom_bar(stat="identity", color="black",position=position_dodge2(preserve="single", padding=0), alpha=0.5) +
geom_errorbar(aes(ymin=mean, ymax=mean+se), alpha=1, width=.2,position=position_dodge(.9)) +
theme(panel.grid = element_blank(),legend.position = "bottom") +
labs(x="Litter Type", y="Nitrate (micro grams/10cm2/burial length)", pattern="") + scale_fill_manual(values=cols)+
geom_bar_pattern(stat="identity", position = "dodge", color = "black", pattern_angle = 45, pattern_density = 0.1, pattern_spacing = 0.025, pattern_key_scale_factor = 0.6) +
facet_grid(~ burial, scales = "free") +
scale_color_manual( values=c("#004D40", "#FFC107")) +
NO3.plot
a<-ggplot(COroots, aes(x = Invasion, y = mean, fill = grp, pattern=Treatment, alpha=alfa)) +
geom_bar(stat="identity", color="black",position=position_dodge2(preserve="single", padding=0), alpha=0.5) +
geom_errorbar(aes(ymin=mean, ymax=mean+se), alpha=1, width=.2,position=position_dodge(.9)) +
theme(panel.grid = element_blank(),legend.position = "bottom") +
labs(x="Soil Type", y="Root Mass (g)", pattern="") + scale_fill_manual(values=cols)+
geom_bar_pattern(stat="identity", position = "dodge", color = "black", pattern_angle = 45, pattern_density = 0.1, pattern_spacing = 0.025, pattern_key_scale_factor = 0.6) +
scale_pattern_manual(values = c("stripe", "none")) +
theme(axis.text.x = element_text(size=11, colour= "black", angle = 0),axis.text.y = element_text(size=12, colour="black"),strip.text = element_text(size = 10))+
theme(axis.title.x = element_text(size=12, colour="black"), axis.title.y = element_text(size= 12, colour = "black"))+
theme(legend.title = element_blank())+theme(axis.ticks.x = element_blank())+
theme(panel.grid = element_blank(),legend.position = "bottom")+
theme(legend.title = element_blank())+theme(legend.text = element_text(size = 10, colour = "black"))+
theme(legend.background = element_blank())+ylim(0, 2.0) +
facet_grid(~ Grown, scales = "free") +
geom_signif(data=data.frame(Grown=c("Linaria", "Native")), aes(xmin =c(1,1), xmax = c(2,2), y_position = c(0.95, 1.95), annotations=c("*","*")), tip_length = 0, manual=T, inherit.aes = FALSE) +
guides(pattern = guide_legend(override.aes = list(fill = "white")),fill = guide_legend(override.aes = list(pattern = "none"))) +
guides(fill=FALSE)+ guides(size="none", alpha="none")
NO3.plot <- ggplot(data = soil.NO3, aes(x = litter, y = mean, color = removal, pattern = removal)) +
geom_bar(stat="identity", color="black",position=position_dodge2(preserve="single", padding=0), alpha=0.5) +
geom_errorbar(aes(ymin=mean, ymax=mean+se), alpha=1, width=.2,position=position_dodge(.9)) +
theme(panel.grid = element_blank(),legend.position = "bottom") +
labs(x="Litter Type", y="Nitrate (micro grams/10cm2/burial length)", pattern="") + scale_fill_manual(values=cols)+
geom_bar_pattern(stat="identity", position = "dodge", color = "black", pattern_angle = 45, pattern_density = 0.1, pattern_spacing = 0.025, pattern_key_scale_factor = 0.6) +
facet_grid(~ burial, scales = "free") +
scale_color_manual( values=c("#004D40", "#FFC107")) +
NO3.plot
NO3.plot <- ggplot(data = soil.NO3, aes(x = litter, y = mean, color = removal, pattern = removal)) +
geom_bar(stat="identity", color="black",position=position_dodge2(preserve="single", padding=0), alpha=0.5) +
geom_errorbar(aes(ymin=mean, ymax=mean+se), alpha=1, width=.2,position=position_dodge(.9)) +
theme(panel.grid = element_blank(),legend.position = "bottom") +
labs(x="Litter Type", y="Nitrate (micro grams/10cm2/burial length)", pattern="") + scale_fill_manual(values=cols)+
geom_bar_pattern(stat="identity", position = "dodge", color = "black", pattern_angle = 45, pattern_density = 0.1, pattern_spacing = 0.025, pattern_key_scale_factor = 0.6) +
facet_grid(~ burial, scales = "free") +
scale_color_manual( values=c("#004D40", "#FFC107"))
NO3.plot
NO3.plot <- ggplot(data = soil.NO3, aes(x = litter, y = mean, fill = removal, pattern = removal)) +
geom_bar(stat="identity", color="black",position=position_dodge2(preserve="single", padding=0), alpha=0.5) +
geom_errorbar(aes(ymin=mean, ymax=mean+se), alpha=1, width=.2,position=position_dodge(.9)) +
theme(panel.grid = element_blank(),legend.position = "bottom") +
labs(x="Litter Type", y="Nitrate (micro grams/10cm2/burial length)", pattern="") + scale_fill_manual(values=cols)+
geom_bar_pattern(stat="identity", position = "dodge", color = "black", pattern_angle = 45, pattern_density = 0.1, pattern_spacing = 0.025, pattern_key_scale_factor = 0.6) +
facet_grid(~ burial, scales = "free") +
scale_color_manual( values=c("#004D40", "#FFC107"))
NO3.plot
NO3.plot <- ggplot(data = soil.NO3, aes(x = litter, y = mean, fill = removal, pattern = removal)) +
geom_bar(stat="identity", color="black",position=position_dodge2(preserve="single", padding=0), alpha=0.5) +
geom_errorbar(aes(ymin=mean, ymax=mean+se), alpha=1, width=.2,position=position_dodge(.9)) +
theme(panel.grid = element_blank(),legend.position = "bottom") +
labs(x="Litter Type", y="Nitrate (micro grams/10cm2/burial length)", pattern="") + scale_fill_manual(values=cols)+
geom_bar_pattern(stat="identity", position = "dodge", color = "black", pattern_angle = 45, pattern_density = 0.1, pattern_spacing = 0.025, pattern_key_scale_factor = 0.6) +
facet_grid(~ burial, scales = "free") +
scale_fill_manual( values=c("#004D40", "#FFC107"))
NO3.plot
NO3.plot <- ggplot(data = soil.NO3, aes(x = litter, y = mean, fill = removal, pattern = removal)) +
geom_bar(stat="identity", color="black",position=position_dodge2(preserve="single", padding=0), alpha=0.5) +
geom_errorbar(aes(ymin=mean, ymax=mean+se), alpha=1, width=.2,position=position_dodge(.9)) +
theme(panel.grid = element_blank(),legend.position = "bottom") +
labs(x="Litter Type", y="Nitrate (micro grams/10cm2/burial length)", pattern="") + scale_fill_manual(values=cols)+
geom_bar_pattern(stat="identity", position = "dodge", color = "black", pattern_angle = 45, pattern_density = 0.1, pattern_spacing = 0.025, pattern_key_scale_factor = 0.6) +
scale_fill_manual( values=c("#004D40", "#FFC107"))
NO3.plot
