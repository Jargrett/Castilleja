emotes::install_version("Matrix", version = "1.6.3")
remotes::install_version("Matrix", version = "1.6.3")
install.packages("lme4", type = "source")  # 1.1.35.1
remotes::install_version("Matrix", version = "1.6.4")
library(lme4)
library(metagear)
install.packages("gasanalyzer")
library(gasanalyzer)
setwd("/Users/jargrett/Desktop/Castilleja/Data Analysis/RMBL Castilleja Experimental Project")
setwd(
#Set the working directory
setwd("/Users/jargrett/Desktop/Castilleja/Data Analysis/Callie Data/HPM")
#load in relevant packages
library(plyr)#for data wrangling and restructuring
library(tidyverse)#for data wrangling and restructuring
library(statmod)
library(lme4)
library(emmeans)#post-hoc analysis
library(car)#for regression analysis
library(ggpubr)#post-hoc analysis
library(ggplot2)#post-hoc analysis
#Height: import, clean and rename height data
height <- read.csv("HPM Growth - Height.csv")
setwd("~/Desktop/Castilleja/Data Analysis/RMBL/Emerald Lake/Plant Data")
#---------------Data importing, cleaning, and resctructuring---------------#
library(tidyverse)#for data wrangling and restructuring
library(magrittr)#for data wrangling and restructuring
library(plyr)#for data wrangling and restructuring
library(conflicted)#helps reslove errors for similar functions between packages
library(car)
conflicted::conflicts_prefer(dplyr::recode)
conflicts_prefer(plyr::mutate)
conflicts_prefer(dplyr::filter)
#load in cover data
cover.pre <- read.csv("Emerald Lake Plant Data - pre.csv")
View(cover.pre)
#load in cover data
cover.pre <- read.csv("Emerald Lake Plant Data - pre.csv")
cover.23 <- read.csv("Emerald Lake Plant Data - 2023.csv")
cover.24 <- read.csv("Emerald Lake Plant Data - 2024.csv")
cover.25 <- read.csv("Emerald Lake Plant Data - 2025.csv")
#combine datasets
cover.comb <- rbind.fill(cover.pre,cover.23,cover.24,cover.25)
cover.comb <- as.data.frame(unclass(cover.comb),stringsAsFactors=TRUE)
cover.comb %<>%
mutate(removal = recode(removal,
"C" = "Control",
"R" = "Removal"))
View(cover.comb)
#remove castilleja and environmental rows for analysis
cover.comb.clean <- cover.comb[!(cover.comb$functional_group %in% "environmental"),]
cover.comb.clean <- cover.comb.clean[!(cover.comb.clean$code %in% "CASE"),]
comb.cov <- subset(cover.comb.clean, select = c('year','plot','code','percent_cover'))
#filter for year/pre and calculate
emerald.pre <- comb.cov %>%
filter (year == "Pre") %>%
select(-c(year))
emerald.23 <- comb.cov %>%
filter (year == "2023") %>%
select(-c(year))
emerald.24 <- comb.cov %>%
filter (year == "2024") %>%
select(-c(year))
emerald.25 <- comb.cov %>%
filter (year == "2025") %>%
select(-c(year))
#convert to matrix format for diversity calculations
library(labdsv)#enables restructuring for ecological analysis
emerald.pre.matrix <- matrify(emerald.pre)
emerald.23.matrix <- matrify(emerald.23)
emerald.24.matrix <- matrify(emerald.24)
emerald.25.matrix <- matrify(emerald.25)
m = list(emerald.23.matrix, el.24.matrix, el.25.matrix)
emerald.matrix <- bind_rows(m)
emerald.matrix %<>%  replace(is.na(.), 0) %>%
relocate(year)
#---------------Diversity Calculations---------------#
library(vegan)#for calculating diversity
# Calculating Shannon diversity for plots
div.pre <- diversity(emerald.pre.matrix, index = "shannon")
div.23 <- diversity(emerald.23.matrix, index = "shannon")
div.24 <- diversity(emerald.24.matrix, index = "shannon")
div.25 <- diversity(emerald.25.matrix, index = "shannon")
# Calculating species richness for plots
rich.pre <- specnumber(emerald.pre.matrix)
rich.23 <- specnumber(emerald.23.matrix)
rich.24 <- specnumber(emerald.24.matrix)
rich.25 <- specnumber(emerald.25.matrix)
# Calculating species evenness for plots
even.pre <- diversity(emerald.pre.matrix, index = "shannon") / log(specnumber(emerald.pre.matrix))
even.23 <- diversity(emerald.23.matrix, index = "shannon") / log(specnumber(emerald.23.matrix))
even.24 <- diversity(emerald.24.matrix, index = "shannon") / log(specnumber(emerald.24.matrix))
even.25 <- diversity(emerald.25.matrix, index = "shannon") / log(specnumber(emerald.25.matrix))
#---------------Combining results and exporting---------------#
setwd("~/Desktop/Castilleja/Data Analysis/RMBL/Emerald Lake")
plot <- read.csv("Emerald Lake Plot Data - Info.csv")
plot %<>%
mutate(removal = recode(removal,
"C" = "Control",
"R" = "Removal"))
setwd("~/Desktop/Castilleja/Data Analysis/RMBL/Emerald Lake/Plant Data")
el.pre <- cbind(plot,div.pre,rich.pre,even.pre)
el.pre %<>%
plyr::mutate(year = 'pre') %>%
relocate(year) %>%
dplyr::rename(div = div.pre, rich = rich.pre, even = even.pre)
el.23 <- cbind(plot,div.23,rich.23,even.23)
el.23 %<>%
plyr::mutate(year = '2023') %>%
relocate(year) %>%
dplyr::rename(div = div.23, rich = rich.23, even = even.23)
el.24 <- cbind(plot,div.24,rich.24,even.24)
el.24 %<>%
plyr::mutate(year = '2024') %>%
relocate(year) %>%
dplyr::rename(div = div.24, rich = rich.24, even = even.24)
el.25 <- cbind(plot,div.25,rich.25,even.25)
el.25 %<>%
plyr::mutate(year = '2025') %>%
relocate(year) %>%
dplyr::rename(div = div.25, rich = rich.25, even = even.25)
diversity.pre <- rbind.fill(el.pre,el.23,el.24,el.25)
diversity <- rbind.fill(el.23,el.24,el.25)
write.csv(diversity, "~/Desktop/Castilleja/Data Analysis/RMBL/Emerald Lake/Plant Data/Plant Diversity.csv", row.names=FALSE)
View(diversity)
View(cover.pre)
View(cover.comb)
setwd("~/Desktop/Castilleja/Data Analysis/Host Parasite Microbe Project")
#Set the working directory
setwd("~/Desktop/Castilleja/Data Analysis/Host Parasite Microbe Project")
#load in relevant packages
library(plyr)#for data wrangling and restructuring
library(tidyverse)#for data wrangling and restructuring
library(statmod)
library(lme4)
library(emmeans)#post-hoc analysis
library(car)#for regression analysis
library(ggpubr)#post-hoc analysis
library(ggplot2)#post-hoc analysis
height <- read.csv("Raw Data/HPM Microscopty - AMF.csv")
micro <- read.csv("Raw Data/HPM Microscopy - AMF.csv")
View(micro)
View(micro)
#Set the working directory
setwd("~/Desktop/Castilleja/Data Analysis/Host Parasite Microbe Project")
#----------Packages----------#
#data cleaning and structuring
library(tidyverse)
library(conflicted)
library(magrittr)
#Statistical Analysis
library(statmod)
library(lme4)
library(emmeans)
library(car)
#Figures and Tables
library(ggpubr)
library(ggplot2)
#----------Data Working----------#
#Reading in the data from a downloaded csv (text) file
micro <- read.csv("Raw Data/HPM Microscopy - AMF.csv")
#Removing all slides that have not been measured
micro %<>% drop_na(views)
View(micro)
#Removing all slides that have not been measured
micro <- microscopy %>%  drop_na(views)
#----------Data Working----------#
#Reading in the data from a downloaded csv (text) file
micro <- read.csv("Raw Data/HPM Microscopy - AMF.csv")
#----------Data Working----------#
#Reading in the data from a downloaded csv (text) file
microscopy <- read.csv("Raw Data/HPM Microscopy - AMF.csv")
#Removing all slides that have not been measured
micro <- microscopy %>%  drop_na(views)
View(micro)
str(micro)
micro <- as.data.frame(unclass(micro),stringsAsFactors=TRUE)
#checking data structure
str(micro)
View(micro)
#Removing all slides that have not been measured
micro <- microscopy %>%
drop_na(views) %>%
filter(type != "parasite")
View(micro)
View(micro)
#----------Analysis----------#
#Effect of innoculuation on colonization
col.lmm <- lmer(col_total ~ treatment*type + (1|replicate_id), data = micro)
str(microscopy)
View(microscopy)
micro %<>% convert(num(col_total))
install.packages("hablar")
library(hablar)
micro %<>% convert(num(col_total))
micro %<>% convert(hablar::num(col_total))
#----------Analysis----------#
#Effect of innoculuation on colonization
col.lmm <- lmer(col_total ~ treatment*type + (1|replicate_id), data = micro)
summary(col.lmm)
Anova(col.lmm)
View(micro)
emmeans(col.lmm, pairwise ~ type|treatment)
emmip(col.lmm, ~ type ~ treatment)
library(ggstatsplot)
col.plot <- ggbetweenstats(data = micro, x = treatment, y = col_total)
col.plot
micro %<>% convert(hablar::num(col_total)) %>%
convert(hablar::num(col_hyphae))
hyphae.lmm <- lmer(col_hyphae ~ treatment*type + (1|replicate_id), data = micro)
summary(hyphae.lmm)
Anova(hyphae.lmm)
emmeans(hyphae.lmm, pairwise ~ type|treatment)
emmip(hyphae.lmm, ~ type ~ treatment)
hyphae.plot <- ggbetweenstats(data = micro, x = treatment, y = col_hyphae)
hyphae.plot
emmeans(hyphae.lmm, pairwise ~ treatment|type)
extra.plot <- ggbetweenstats(data = micro, x = treatment, y = col_extra)
extra.plot
micro %<>% convert(hablar::num(col_total)) %>%
convert(hablar::num(col_hyphae)) %>%
convert(hablar::num(col_extra))
extra.plot <- ggbetweenstats(data = micro, x = treatment, y = col_extra)
extra.plot
extra.lmm <- lmer(col_extra ~ treatment*type + (1|replicate_id), data = micro)
summary(extra.lmm)
Anova(extra.lmm)
emmeans(extra.lmm, pairwise ~ treatment|type)
emmip(extra.lmm, ~ type ~ treatment)
extra.plot <- ggbetweenstats(data = micro, x = treatment, y = col_extra)
extra.plot
extra.plot <- ggbetweenstats(data = micro, x = type, y = col_extra)
extra.plot
#Set the working directory
setwd("~/Desktop/Castilleja/Data Analysis/Host Parasite Microbe Project")
#----------Packages----------#
#data cleaning and structuring
library(tidyverse)
#Set the working directory
setwd("~/Desktop/Castilleja/Data Analysis/Host Parasite Microbe Project")
#----------Packages----------#
#data cleaning and structuring
library(tidyverse)
library(conflicted)
library(magrittr)
library(hablar)
#Statistical Analysis
library(statmod)
library(lme4)
library(emmeans)
library(car)
library(ggstatsplot)
#Figures and Tables
library(ggpubr)
library(ggplot2)
#----------Data Working----------#
#Reading in the data from a downloaded csv (text) file
microscopy <- read.csv("Raw Data/HPM Microscopy - AMF.csv")
#Removing all slides that have not been measured and removing parasite alone slides
micro <- microscopy %>%
drop_na(views) %>%
filter(type != "parasite")
View(micro)
View(microscopy)
#checking data structure
str(micro)
#Converting strings to factors for analaysis
micro <- as.data.frame(unclass(micro),stringsAsFactors=TRUE)
micro %<>% convert(hablar::num(col_total)) %>%
convert(hablar::num(col_hyphae)) %>%
convert(hablar::num(col_extra))
#checking data structure
str(micro)
#----------Analysis----------#
#Effect of innoculuation on colonization
col.lmm <- lmer(col_total ~ treatment*type + (1|replicate_id), data = micro)
summary(col.lmm)
Anova(col.lmm)
col.plot <- ggbetweenstats(data = micro, x = treatment, y = col_total)
col.plot
hyphae.lmm <- lmer(col_hyphae ~ treatment*type + (1|replicate_id), data = micro)
summary(hyphae.lmm)
Anova(hyphae.lmm)
hyphae.plot <- ggbetweenstats(data = micro, x = treatment, y = col_hyphae)
hyphae.plot
extra.lmm <- lmer(col_extra ~ treatment*type + (1|replicate_id), data = micro)
summary(extra.lmm)
Anova(extra.lmm)
emmeans(extra.lmm, pairwise ~ treatment|type)
emmip(extra.lmm, ~ type ~ treatment)
extra.plot <- ggbetweenstats(data = micro, x = treatment, y = col_extra)
extra.plot
