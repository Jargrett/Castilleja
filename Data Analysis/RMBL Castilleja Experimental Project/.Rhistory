abundance.var = "count",
replicate.var = "plot",
reference.time = "1")
abund.count %<>%
filter(year2 != "2") %>%
select(plot, code, change) %>%
rename(count_change = change)
abund_merge_count <- merge(abund.count, meta, by = "plot")
abund_mean_cover <- abund_merge_cover %>%
group_by(code, removal) %>%
summarise(mean_change_cover = mean(percent_change),
se_change_cover = sd(percent_change)/sqrt(n()))
abund_mean_count <- abund_merge_count %>%
group_by(code, removal) %>%
summarise(mean_change_count = mean(count_change),
se_change_count = sd(count_change)/sqrt(n()))
abund_full <- inner_join(abund_mean_cover, abund_mean_count, by = c("code", 'removal'))
#importing dominance data
species_info <- read.csv("Raw Data/EL Species List - EL.csv")
species_code <- species_info %>%
distinct(code, functional_group, life_history, growth_form)
dom_year <- readRDS("Processed Data/Dominance y1.rds")
dom_year %<>%
mutate(removal = recode(removal,
"Control" = "Present",
"Removal" = "Removed"))
abund_merge_year <- merge(dom_year, abund_full,
by = c("code","removal"),
all.x = T, all.y = T) %>%
drop_na(freq)
yearly.rarity <- full_join(species_code, abund_merge_year, by = "code") %>%
drop_na(removal)
dom_total <- readRDS("Processed Data/Dominance total.rds")
dom_total %<>%
mutate(removal = recode(removal,
"Control" = "Present",
"Removal" = "Removed"))
abund_merge_total <- merge(dom_total, abund_full,
by = c("code","removal"),
all.x = T, all.y = T)
total.rarity <- full_join(species_code, abund_merge_total, by = "code") %>%
drop_na(removal) %>%
drop_na(mean_change_cover)
ggplot(total.rarity, aes(x = occurance, y = mean_change_cover, color = occurance)) +
geom_point() +
ylim(-0.3, 0.3)
ggplot(total.rarity, aes(x = functional_group, y = mean_change_cover, color = occurance)) +
geom_point() +
ylim(-0.3, 0.3)
#Functional Group Change
ac.lm <- lm(mean_change_cover ~ removal*functional_group, data = total.rarity)
summary(ac.lm)
Anova(ac.lm)
ggplot(total.rarity, aes(x = functional_group, y = mean_change_cover, color = removal)) +
geom_point() +
ylim(-0.3, 0.3)
ggplot(total.rarity, aes(x = functional_group, y = mean_change_count, color = removal)) +
geom_point() +
ylim(-0.3, 0.3)
ggplot(total.rarity, aes(x = mean_rel_cover_site, y = mean_change_count, color = removal)) +
geom_point() +
ylim(-0.3, 0.3)
ggplot(total.rarity, aes(x = mean_rel_cover_site, y = mean_change_cover, color = removal)) +
geom_point() +
ylim(-0.3, 0.3)
ggplot(total.rarity, aes(x = mean_rel_cover_site, y = mean_change_cover, color = dominace)) +
geom_point() +
ylim(-0.3, 0.3)
ggplot(total.rarity, aes(x = mean_rel_cover_site, y = mean_change_cover, color = dominance)) +
geom_point() +
ylim(-0.3, 0.3)
ggplot(total.rarity, aes(x = mean_rel_cover_site, y = mean_change_cover, color = dominance)) +
geom_point() +
ylim(-0.3, 0.3) +
geom_smooth(method = "lm", se = FALSE)
ggplot(total.rarity, aes(x = mean_rel_cover_site, y = mean_change_cover, color = dominance)) +
geom_point() +
ylim(-0.3, 0.3) +
geom_smooth(method = "lm")
#Functional Group Change
ac.lm <- lm(mean_change_cover ~ mean_rel_cover_site*functional_group, data = total.rarity)
summary(ac.lm)
Anova(ac.lm)
#Functional Group Change
ac.lm <- lm(mean_change_cover ~ mean_rel_cover_site*dominance, data = total.rarity)
summary(ac.lm)
Anova(ac.lm)
ggplot(yearly.rarity, aes(x = mean_rel_cover_site, y = mean_change_cover, color = dominance)) +
geom_point() +
ylim(-0.3, 0.3) +
geom_smooth(method = "lm")
ggplot(yearly.rarity, aes(x = mean_rel_cover_site, y = mean_change_cover, color = dominance)) +
geom_point() +
ylim(-0.3, 0.3) +
geom_smooth(method = "lm") +
facet_wrap(~removal)
#Functional Group Change
ac.lm <- lm(mean_change_cover ~ mean_rel_cover_site*removal, data = total.rarity)
summary(ac.lm)
Anova(ac.lm)
ggplot(yearly.rarity, aes(x = code, y = mean_change_cover, color = dominance)) +
geom_point() +
ylim(-0.3, 0.3) +
geom_smooth(method = "lm") +
facet_wrap(~removal)
ggplot(yearly.rarity, aes(x = removal, y = mean_change_cover, color = dominance)) +
geom_point() +
ylim(-0.3, 0.3) +
geom_smooth(method = "lm") +
facet_wrap(~removal)
ggplot(total.rarity, aes(x = removal, y = mean_change_cover, color = dominance)) +
geom_point() +
ylim(-0.3, 0.3) +
geom_smooth(method = "lm") +
facet_wrap(~removal)
#Functional Group Change
ac.lm <- lm(mean_change_cover ~ removal, data = yearly.rarity)
summary(ac.lm)
Anova(ac.lm)
#Functional Group Change
ac.lm <- lm(mean_change_cover ~ removal, data = total.rarity)
summary(ac.lm)
Anova(ac.lm)
#Full data
ac.lm <- lm(mean_change ~ removal*functional_group, data = total.rarity)
summary(ac.lm)
Anova(ac.lm)
#Full data
ac.lm <- lm(mean_change ~ removal*functional_group, data = total.rarity)
#Full data
ac.lm <- lm(mean_change_cover ~ removal*functional_group, data = total.rarity)
summary(ac.lm)
Anova(ac.lm)
#Full data
ac.lm <- lm(mean_change_cover ~ functional_group, data = total.rarity)
summary(ac.lm)
Anova(ac.lm)
ggplot(total.rarity, aes(x = functional_group, y = mean_change_cover, color = dominance)) +
geom_point() +
ylim(-0.3, 0.3) +
geom_smooth(method = "lm") +
facet_wrap(~removal)
#-------Abundance change Analysis-----#
#year 1 abund only data
ac.lm <- lm(mean_change_count ~ removal*dominance, data = yearly.rarity)
ggplot(total.rarity, aes(x = functional_group, y = mean_change_cover, color = dominance)) +
geom_point() +
ylim(-0.3, 0.3) +
geom_smooth(method = "lm") +
facet_wrap(~removal)
ggplot(total.rarity, aes(x = growth_form, y = mean_change_cover, color = dominance)) +
geom_point() +
ylim(-0.3, 0.3) +
geom_smooth(method = "lm") +
facet_wrap(~removal)
#Functional Group Change
ac.lm <- lm(mean_change_cover ~ growth_form, data = total.rarity)
summary(ac.lm)
Anova(ac.lm)
total_turn <- species_turnover(between_cover,
time.var = "year",
species.var = "code",
abundance.var = "percent_cover",
replicate.var = "plot")
#Compare whether the rank abundance structure differs between removal at end of study
between_cover <- clean_cover %>%
filter (year != "2")
total_turn <- turnover(between_cover,
time.var = "year",
species.var = "code",
abundance.var = "percent_cover",
replicate.var = "plot")
app_turn <- turnover(between_cover,
time.var = "year",
species.var = "code",
abundance.var = "percent_cover",
replicate.var = "plot",
metric = "appearance")
diss_turn <- turnover(between_cover,
time.var = "year",
species.var = "code",
abundance.var = "percent_cover",
replicate.var = "plot",
metric = "disappearance")
total_turn <- left_join(plot_data, total_turn, by = "plot")
total_turn <- left_join(total_turn, app_turn, by = "plot")
total_turn <- left_join(total_turn, diss_turn, by = "plot")
species_turn <- species_turnover(between_cover,
time.var = "year",
species.var = "code",
abundance.var = "percent_cover",
replicate.var = "plot")
species_change <- species_turnover(between_cover,
time.var = "year",
species.var = "code",
abundance.var = "percent_cover",
replicate.var = "plot")
species <- species_change(between_cover,
time.var = "year",
species.var = "code",
abundance.var = "percent_cover",
replicate.var = "plot")
#---species identity changes---#
pa_data <- clean_cover %>%
complete(plot, year, code, fill = list(cover = 0)) %>%
mutate(present = ifelse(cover > 0, 1, 0))
View(pa_data)
View(clean_cover)
#---species identity changes---#
pa_cover <- clean_cover %>%
complete(plot, year, code, removal, fill = list(cover = 0)) %>%
mutate(present = ifelse(cover > 0, 1, 0))
View(pa_cover)
#---species identity changes---#
pa_cover <- clean_cover %>%
complete(plot, year, code, fill = list(cover = 0)) %>%
mutate(present = ifelse(cover > 0, 1, 0)) %>%
select(year, plot, code, present)
View(pa_cover)
#---species identity changes---#
pa_cover <- clean_cover %>%
complete(plot, year, code, fill = list(cover = 0)) %>%
mutate(present = ifelse(cover > 0, 1, 0)) %>%
select(year, plot, code, present) %>%
filter(code != "bare") %>%
filter(code != "litter") %>%
filter(code != "rock") %>%
filter(code != "CASE") %>%
#-----species abundance changes----#
meta <- plot_data %>%
select(plot,removal)
#---species identity changes---#
pa_cover <- clean_cover %>%
complete(plot, year, code, fill = list(cover = 0)) %>%
mutate(present = ifelse(cover > 0, 1, 0)) %>%
select(year, plot, code, present) %>%
filter(code != "bare") %>%
filter(code != "litter") %>%
filter(code != "rock") %>%
filter(code != "CASE") %>%
#-----species abundance changes----#
meta <- plot_data %>%
select(plot,removal)
#---species identity changes---#
pa_cover <- clean_cover %>%
complete(plot, year, code, fill = list(cover = 0)) %>%
mutate(present = ifelse(cover > 0, 1, 0)) %>%
select(year, plot, code, present)
#---species identity changes---#
pa_cover <- clean_cover %>%
complete(plot, year, code, fill = list(cover = 0)) %>%
mutate(present = ifelse(cover > 0, 1, 0)) %>%
select(year, plot, code, present) %>%
filter(code != "bare") %>%
filter(code != "litter") %>%
#-----species abundance changes----#
meta <- plot_data %>%
select(plot,removal)
#---species identity changes---#
pa_cover <- clean_cover %>%
complete(plot, year, code, fill = list(cover = 0)) %>%
mutate(present = ifelse(cover > 0, 1, 0)) %>%
select(year, plot, code, present) %>%
filter(code != "bare")
#---species identity changes---#
pa_cover <- clean_cover %>%
complete(plot, year, code, fill = list(cover = 0)) %>%
mutate(present = ifelse(cover > 0, 1, 0)) %>%
select(year, plot, code, present) %>%
filter(code != "bare") %>%
filter(code != "litter") %>%
#-----species abundance changes----#
meta <- plot_data %>%
select(plot,removal)
#---species identity changes---#
pa_cover <- clean_cover %>%
complete(plot, year, code, fill = list(cover = 0)) %>%
mutate(present = ifelse(cover > 0, 1, 0)) %>%
select(year, plot, code, present) %>%
filter(code != "bare") %>%
filter(code != "rock") %>%
filter(code != "CASE") %>%
#-----species abundance changes----#
meta <- plot_data %>%
select(plot,removal)
#---species identity changes---#
pa_cover <- clean_cover %>%
complete(plot, year, code, fill = list(cover = 0)) %>%
mutate(present = ifelse(cover > 0, 1, 0)) %>%
select(year, plot, code, present) %>%
#-----species abundance changes----#
meta <- plot_data %>%
select(plot,removal)
#---species identity changes---#
pa_cover <- clean_cover %>%
complete(plot, year, code, fill = list(cover = 0)) %>%
mutate(present = ifelse(cover > 0, 1, 0)) %>%
select(year, plot, code, present) %>%
filter(code != "bare") %>%
filter(code != "litter") %>%
filter(code != "rock") %>%
filter(code != "CASE")
View(pa_cover)
View(pa_cover)
species_changes <- pa_cover %>%
arrange(plot, code, year) %>%
group_by(plot, code) %>%
mutate(change = present - lag(present)) %>%
ungroup()
conflicted::conflicts_prefer(dplyr::lag)
species_changes <- pa_cover %>%
arrange(plot, code, year) %>%
group_by(plot, code) %>%
mutate(change = present - lag(present)) %>%
ungroup()
View(species_changes)
species_changes <- pa_cover %>%
filter(code != "2") %>%
arrange(plot, code, year) %>%
group_by(plot, code) %>%
mutate(change = present - lag(present)) %>%
ungroup()
View(species_changes)
species_changes <- pa_cover %>%
filter(year != "2") %>%
arrange(plot, code, year) %>%
group_by(plot, code) %>%
mutate(change = present - lag(present)) %>%
ungroup()
View(species_changes)
#---species identity changes---#
pa_cover <- clean_cover %>%
complete(plot, year, code, fill = list(cover = 0)) %>%
mutate(present = ifelse(cover > 0, 1, 0)) %>%
select(year, plot, code, present) %>%
filter(code != "bare") %>%
filter(code != "litter") %>%
filter(code != "rock") %>%
filter(code != "CASE") %>%
filter(year != "2")
species_changes <- pa_cover %>%
arrange(plot, code, year) %>%
group_by(plot, code) %>%
mutate(change = present - lag(present)) %>%
ungroup()
species_change %<>%
pivot_wider(names_from = year, values_from = change)
species_changes %<>%
pivot_wider(names_from = year, values_from = change)
View(species_changes)
species_changes <- pa_cover %>%
arrange(plot, code, year) %>%
group_by(plot, code) %>%
mutate(change = present - lag(present)) %>%
ungroup()
View(species_changes)
species_changes %<>%
pivot_wider(names_from = year, values_from = present)
species_changes <- pa_cover %>%
arrange(plot, code, year) %>%
group_by(plot, code) %>%
mutate(change = present - lag(present)) %>%
ungroup()
View(species_changes)
#---species identity changes---#
pa_cover <- clean_cover %>%
complete(plot, year, code, fill = list(cover = 0)) %>%
mutate(present = ifelse(cover > 0, 1, 0)) %>%
select(year, plot, code, present) %>%
filter(code != "bare") %>%
filter(code != "litter") %>%
filter(code != "rock") %>%
filter(code != "CASE") #%>%
species_changes <- pa_cover %>%
arrange(plot, code, year) %>%
group_by(plot, code) %>%
mutate(change = present - lag(present)) %>%
ungroup()
species_changes %<>%
pivot_wider(names_from = year, values_from = present)
#---species identity changes---#
pa_cover <- clean_cover %>%
complete(plot, year, code, fill = list(cover = 0)) %>%
mutate(present = ifelse(cover > 0, 1, 0)) %>%
select(year, plot, code, present) %>%
filter(code != "bare") %>%
filter(code != "litter") %>%
filter(code != "rock") %>%
filter(code != "CASE") #%>%
#---species identity changes---#
pa_cover <- clean_cover %>%
complete(plot, year, code, fill = list(cover = 0)) %>%
mutate(present = ifelse(cover > 0, 1, 0)) %>%
select(year, plot, code, present) %>%
filter(code != "bare") %>%
filter(code != "litter") %>%
filter(code != "rock") %>%
filter(code != "CASE") %>%
filter(year != "2")
species_changes <- pa_cover %>%
arrange(plot, code, year) %>%
group_by(plot, code) %>%
mutate(change = present - lag(present)) %>%
ungroup()
#---species identity changes---#
pa_cover <- clean_cover %>%
complete(plot, year, code, fill = list(cover = 0)) %>%
mutate(present = ifelse(cover > 0, 1, 0)) %>%
select(year, plot, code, present) %>%
filter(code != "bare") %>%
filter(code != "litter") %>%
filter(code != "rock") %>%
filter(code != "CASE") %>%
filter(year != "2")
View(pa_cover)
#---species identity changes---#
pa_cover <- clean_cover %>%
complete(plot, year, code, fill = list(cover = 0)) %>%
mutate(present = ifelse(cover > 0, 1, 0)) %>%
select(year, plot, code, present) %>%
filter(code != "bare") %>%
filter(code != "litter") %>%
filter(code != "rock") %>%
filter(code != "CASE") %>%
filter(year != "2") %>%
pivot_wider(names_from = year, values_from = present)
View(pa_cover)
#---species identity changes---#
pa_cover <- clean_cover %>%
complete(plot, year, code, fill = list(cover = 0)) %>%
mutate(present = ifelse(cover > 0, 1, 0)) %>%
select(year, plot, code, present) %>%
filter(code != "bare") %>%
filter(code != "litter") %>%
filter(code != "rock") %>%
filter(code != "CASE") %>%
filter(year != "2") %>%
pivot_wider(names_from = year, values_from = present)
View(pa_cover)
#---species identity changes---#
pa_cover <- clean_cover %>%
complete(plot, year, code, fill = list(cover = 0)) %>%
mutate(present = ifelse(cover > 0, 1, 0)) %>%
select(year, plot, code, present) %>%
filter(code != "bare") %>%
filter(code != "litter") %>%
filter(code != "rock") %>%
filter(code != "CASE") %>%
filter(year != "2") %>%
pivot_wider(names_from = year, values_from = present) %>%
rename("y1" = "1",
"y3" = "3")
View(pa_cover)
df_long <- pa_cover %>%
mutate(change = case_when(
y1 == 0 & y3 == 1 ~ "gain",
y1 == 1 & y3 == 0 ~ "loss",
y1 == 1 & y3 == 1 ~ "persist",
TRUE ~ "absent"  # species absent in both years
))
View(df_long)
persist <- pa_cover %>%
mutate(change = case_when(
y1 == 0 & y3 == 1 ~ "gain",
y1 == 1 & y3 == 0 ~ "loss",
y1 == 1 & y3 == 1 ~ "persist",
TRUE ~ "absent")) %>%
filter(change != "absent")
View(persist)
persist %<>%
group_by(code, change) %>%
summarise(n = n())
View(persist)
persist <- pa_cover %>%
mutate(change = case_when(
y1 == 0 & y3 == 1 ~ "gain",
y1 == 1 & y3 == 0 ~ "loss",
y1 == 1 & y3 == 1 ~ "persist",
TRUE ~ "absent")) %>%
filter(change != "absent")
#-----species abundance changes----#
meta <- plot_data %>%
select(plot,removal)
persist %<>%
left_join(meta, by = "plot")
View(persist)
species_gains <- persist %>%
filter(change == "gain") %>%
group_by(removal, code) %>%
summarise(n_plots = n(), .groups = "drop")
View(species_gains)
persist %<>%
left_join(meta, by = "plot")
View(persist)
persist <- pa_cover %>%
mutate(change = case_when(
y1 == 0 & y3 == 1 ~ "gain",
y1 == 1 & y3 == 0 ~ "loss",
y1 == 1 & y3 == 1 ~ "persist",
TRUE ~ "absent")) %>%
filter(change != "absent")
persist %<>%
left_join(meta, by = "plot")
View(persist)
species_prop <- persist %>%
filter(change %in% c("gain", "loss")) %>%
group_by(removal, code, change) %>%
summarise(n_plots = n(), .groups = "drop") %>%
left_join(plots_per_treatment, by = "removal") %>%
mutate(prop = n_plots / n_plots.y) %>%  # proportion of plots in that treatment
select(removal, code, change, prop) %>%
arrange(removal, change, desc(prop))
