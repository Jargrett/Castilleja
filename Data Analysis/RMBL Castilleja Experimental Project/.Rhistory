legend.box.background = element_rect(fill='transparent')) + #transparent legend pane
theme_pubr()
scsc.above
scsc.below <- ggplot(scsc_below_mean, aes(x=pot_type, y=mean, fill=light)) +
geom_col(position = position_dodge(0.7), width = .6, linewidth = 0.75, alpha = 0.9, size = 0.1) +
geom_errorbar(aes(ymin = mean-se, ymax = mean+se),
position =  position_dodge(width = 0.7), width = 0.15) +
labs(x = "Pot combination", y = "Host Belowground Biomass") +
scale_fill_manual(values=c("#45463e","#b3b1be")) +
theme(panel.background = element_rect(fill='transparent'), #transparent panel bg
plot.background = element_rect(fill='transparent', color=NA), #transparent plot bg
legend.background = element_rect(fill='transparent'), #transparent legend bg
legend.box.background = element_rect(fill='transparent')) + #transparent legend pane
theme_pubr()
scsc.below
biomass.plots <- ggarrange(cain.above, scsc.above, cain.below, scsc.below,
labels = c("A", "B","C", "D"),
nrow = 2, ncol = 2)
biomass.plots
#Filter datasets by species so that we can conduct analysis and graph
cain_data <- filter(full_data, plant == "CAIN")#parasite data
cain_data %<>% mutate(pot_type = recode(pot_type,
"HP" = "with host",
"P" = "alone"))
conflicted::conflicts_prefer(dplyr::recode)
conflicts_prefer(dplyr::recode)
#Filter datasets by species so that we can conduct analysis and graph
cain_data <- filter(full_data, plant == "CAIN")#parasite data
cain_data %<>% mutate(pot_type = recode(pot_type,
"HP" = "with host",
"P" = "alone"))
scsc_data <- filter(full_data, plant == "SCSC")#host data
scsc_data %<>% mutate(pot_type = recode(pot_type,
"HP" = "with parasite",
"H" = "alone"))
cain_above <- filter(cain_data, bio_type == "AGB")#parasite data
cain_below <- filter(cain_data, bio_type == "BGB")#parasite data
#----------Graphing----------#
cain_above <- filter(cain_data, bio_type == "AGB")#parasite data
cain_below <- filter(cain_data, bio_type == "BGB")#parasite data
scsc_above <- filter(scsc_data, bio_type == "AGB")#parasite data
scsc_below <- filter(scsc_data, bio_type == "BGB")#parasite data
cain_above_mean <- cain_above %>%
group_by(light, pot_type) %>%
summarise(mean = mean(biomass), se = sd(biomass)/sqrt(n()))
cain_below_mean <- cain_below %>%
group_by(light, pot_type) %>%
summarise(mean = mean(biomass), se = sd(biomass)/sqrt(n()))
scsc_above_mean <- scsc_above %>%
group_by(light, pot_type) %>%
summarise(mean = mean(biomass), se = sd(biomass)/sqrt(n()))
scsc_below_mean <- scsc_below %>%
group_by(light, pot_type) %>%
summarise(mean = mean(biomass), se = sd(biomass)/sqrt(n()))
#We will graph Paraite biomass by our two treatments (pot_type & light)
cain.above <- ggplot(cain_above_mean, aes(x=pot_type, y=mean, fill=light)) +
geom_col(position = position_dodge(0.7), width = .6, linewidth = 0.75, alpha = 0.9, size = 0.1) +
geom_errorbar(aes(ymin = mean-se, ymax = mean+se),
position =  position_dodge(width = 0.7), width = 0.15) +
labs(x = "Pot combination", y = "Parasite Aboveground Biomass") +
scale_fill_manual(values=c("#4b3b40","#b6ad90")) +
theme(panel.background = element_rect(fill='transparent'), #transparent panel bg
plot.background = element_rect(fill='transparent', color=NA), #transparent plot bg
legend.background = element_rect(fill='transparent'), #transparent legend bg
legend.box.background = element_rect(fill='transparent')) + #transparent legend pane
theme_pubr()
cain.above
cain.below <- ggplot(cain_below_mean, aes(x=pot_type, y=mean, fill=light)) +
geom_col(position = position_dodge(0.7), width = .6, linewidth = 0.75, alpha = 0.9, size = 0.1) +
geom_errorbar(aes(ymin = mean-se, ymax = mean+se),
position =  position_dodge(width = 0.7), width = 0.15) +
labs(x = "Pot combination", y = "Parasite Belowground Biomass") +
scale_fill_manual(values=c("#4b3b40","#b6ad90")) +
theme(panel.background = element_rect(fill='transparent'), #transparent panel bg
plot.background = element_rect(fill='transparent', color=NA), #transparent plot bg
legend.background = element_rect(fill='transparent'), #transparent legend bg
legend.box.background = element_rect(fill='transparent')) + #transparent legend pane
theme_pubr()
cain.below
scsc.above <- ggplot(scsc_above_mean, aes(x=pot_type, y=mean, fill=light)) +
geom_col(position = position_dodge(0.7), width = .6, linewidth = 0.75, alpha = 0.9, size = 0.1) +
geom_errorbar(aes(ymin = mean-se, ymax = mean+se),
position =  position_dodge(width = 0.7), width = 0.15) +
labs(x = "Pot combination", y = "Host Aboveground Biomass") +
scale_fill_manual(values=c("#45463e","#b3b1be")) +
theme(panel.background = element_rect(fill='transparent'), #transparent panel bg
plot.background = element_rect(fill='transparent', color=NA), #transparent plot bg
legend.background = element_rect(fill='transparent'), #transparent legend bg
legend.box.background = element_rect(fill='transparent')) + #transparent legend pane
theme_pubr()
scsc.above
scsc.below <- ggplot(scsc_below_mean, aes(x=pot_type, y=mean, fill=light)) +
geom_col(position = position_dodge(0.7), width = .6, linewidth = 0.75, alpha = 0.9, size = 0.1) +
geom_errorbar(aes(ymin = mean-se, ymax = mean+se),
position =  position_dodge(width = 0.7), width = 0.15) +
labs(x = "Pot combination", y = "Host Belowground Biomass") +
scale_fill_manual(values=c("#45463e","#b3b1be")) +
theme(panel.background = element_rect(fill='transparent'), #transparent panel bg
plot.background = element_rect(fill='transparent', color=NA), #transparent plot bg
legend.background = element_rect(fill='transparent'), #transparent legend bg
legend.box.background = element_rect(fill='transparent')) + #transparent legend pane
theme_pubr()
scsc.below
biomass.plots <- ggarrange(cain.above, scsc.above, cain.below, scsc.below,
labels = c("A", "B","C", "D"),
nrow = 2, ncol = 2)
biomass.plots
setwd("~/Desktop/Castilleja/Data Analysis/TK data")
setwd("~/Desktop/Castilleja/Data Analysis/TK data")
library(tidyverse)#for data wrangling and restructuring
library(statmod)
library(lme4)
library(emmeans)#post-hoc analysis
library(car)#for regression analysis
library(ggpubr)#post-hoc analysis
library(ggplot2)#post-hoc analysis
library(gasanalyzer)
microscopy <- read.csv("HPM Microscopy - AMF.csv")
str(microscopy)
microscopy$type[microscopy$type == "host"]
microscopy$type[microscopy$type == "host-parasite"]
microscopy$type[microscopy$type == "parasite"]
hostmicro <- microscopy %>% filter(type == "host")
parasitemicro <- microscopy %>% filter(type == "parasite")
host_parasitemicro <- microscopy %>% filter(type == "host-parasite")
View(microscopy)
setwd("~/Desktop/Castilleja/Data Analysis/TK data")
library(tidyverse)#for data wrangling and restructuring
library(statmod)
library(lme4)
library(emmeans)#post-hoc analysis
library(car)#for regression analysis
library(ggpubr)#post-hoc analysis
library(ggplot2)#post-hoc analysis
library(gasanalyzer)
microscopy <- read.csv("HPM Microscopy - AMF.csv")
str(microscopy)
microscopy$type[microscopy$type == "host"]
microscopy$type[microscopy$type == "host-parasite"]
microscopy$type[microscopy$type == "parasite"]
hostmicro <- microscopy %>% filter(type == "host")
parasitemicro <- microscopy %>% filter(type == "parasite")
host_parasitemicro <- microscopy %>% filter(type == "host-parasite")
View(microscopy)
microscopy$type[microscopy$type == "host"]
str(microscopy)
microscopy <- as.data.frame(unclass(microscopy),stringsAsFactors=TRUE)
str(microscopy)
setwd("~/Desktop/Castilleja/Data Analysis/TK data")
library(tidyverse)#for data wrangling and restructuring
library(statmod)
library(lme4)
library(emmeans)#post-hoc analysis
library(car)#for regression analysis
library(ggpubr)#post-hoc analysis
library(ggplot2)#post-hoc analysis
library(gasanalyzer)
microscopy <- read.csv("HPM Microscopy - AMF.csv")
microscopy <- as.data.frame(unclass(microscopy),stringsAsFactors=TRUE)
str(microscopy)
#Filter the whole dataset into sub dataframes for slide type
hostmicro <- microscopy %>% filter(type == "host")
parasitemicro <- microscopy %>% filter(type == "parasite")
host_parasitemicro <- microscopy %>% filter(type == "host-parasite")
setwd("~/Desktop/Castilleja/Data Analysis/TK data")
library(tidyverse)#for data wrangling and restructuring
library(statmod)
library(lme4)
library(emmeans)#post-hoc analysis
library(car)#for regression analysis
library(ggpubr)#post-hoc analysis
library(ggplot2)#post-hoc analysis
library(gasanalyzer)
microscopy <- read.csv("HPM Microscopy - AMF.csv")
microscopy <- as.data.frame(unclass(microscopy),stringsAsFactors=TRUE)
str(microscopy)
#Filter the whole dataset into sub dataframes for slide type
hostmicro <- microscopy %>% filter(type == "host")
parasitemicro <- microscopy %>% filter(type == "parasite")
host_parasitemicro <- microscopy %>% filter(type == "host-parasite")
View(hostmicro)
View(host_parasitemicro)
View(parasitemicro)
setwd("~/Desktop/Castilleja/Data Analysis/TK data")
library(tidyverse)#for data wrangling and restructuring
library(statmod)
library(lme4)
library(emmeans)#post-hoc analysis
library(car)#for regression analysis
library(ggpubr)#post-hoc analysis
library(ggplot2)#post-hoc analysis
library(gasanalyzer)
microscopy <- read.csv("HPM Microscopy - AMF.csv")
microscopy <- as.data.frame(unclass(microscopy),stringsAsFactors = TRUE)
str(microscopy)
#Filter the whole dataset into sub dataframes for slide type
host_micro <- microscopy %>% filter(type == "host")
parasite_micro <- microscopy %>% filter(type == "parasite")
host_parasite_micro <- microscopy %>% filter(type == "host-parasite")
View(parasite_micro)
#How does sterilization influence fungal presence
parasite_mean <- parasite_micro %>%
group_by(treatment) %>%
summarise(mean = mean(prop_total), se = sd(prop_total)/sqrt(n()))
View(parasite_mean)
parasite_innoc <- ggplot(parasite_mean, aes(x = treatment, y = mean, fill = treatment)) +
geom_col(position = position_dodge(0.7), width = .6, linewidth = 0.75, alpha = 0.9, size = 0.1) +
geom_errorbar(aes(ymin = mean-se, ymax = mean+se),
position =  position_dodge(width = 0.7), width = 0.15) +
labs(x = "Pot combination", y = "Parasite Aboveground Biomass") +
scale_fill_manual(values=c("#4b3b40","#b6ad90")) +
theme(panel.background = element_rect(fill='transparent'), #transparent panel bg
plot.background = element_rect(fill='transparent', color=NA), #transparent plot bg
legend.background = element_rect(fill='transparent'), #transparent legend bg
legend.box.background = element_rect(fill='transparent')) + #transparent legend pane
theme_pubr()
parasite_innoc
#How does sterilization influence fungal presence
parasite_mean <- parasite_micro %>%
filter(across(everything(), ~ . != 0)) %>%
group_by(treatment) %>%
summarise(mean = mean(prop_total), se = sd(prop_total)/sqrt(n()))
View(parasite_mean)
#How does sterilization influence fungal presence
parasite_mean <- parasite_micro %>%
filter(prop_total != 0) %>%
group_by(treatment) %>%
summarise(mean = mean(prop_total), se = sd(prop_total)/sqrt(n()))
View(parasite_mean)
parasite_innoc <- ggplot(parasite_mean, aes(x = treatment, y = mean, fill = treatment)) +
geom_col(position = position_dodge(0.7), width = .6, linewidth = 0.75, alpha = 0.9, size = 0.1) +
geom_errorbar(aes(ymin = mean-se, ymax = mean+se),
position =  position_dodge(width = 0.7), width = 0.15) +
labs(x = "Pot combination", y = "Parasite Aboveground Biomass") +
scale_fill_manual(values=c("#4b3b40","#b6ad90")) +
theme(panel.background = element_rect(fill='transparent'), #transparent panel bg
plot.background = element_rect(fill='transparent', color=NA), #transparent plot bg
legend.background = element_rect(fill='transparent'), #transparent legend bg
legend.box.background = element_rect(fill='transparent')) + #transparent legend pane
theme_pubr()
parasite_innoc
host_mean <- host_micro %>%
filter(prop_total != 0) %>%
group_by(treatment) %>%
summarise(mean = mean(prop_total), se = sd(prop_total)/sqrt(n()))
parasite_innoc <- ggplot(host_mean, aes(x = treatment, y = mean, fill = treatment)) +
geom_col(position = position_dodge(0.7), width = .6, linewidth = 0.75, alpha = 0.9, size = 0.1) +
geom_errorbar(aes(ymin = mean-se, ymax = mean+se),
position =  position_dodge(width = 0.7), width = 0.15) +
labs(x = "Pot combination", y = "Parasite Aboveground Biomass") +
scale_fill_manual(values=c("#4b3b40","#b6ad90")) +
theme(panel.background = element_rect(fill='transparent'), #transparent panel bg
plot.background = element_rect(fill='transparent', color=NA), #transparent plot bg
legend.background = element_rect(fill='transparent'), #transparent legend bg
legend.box.background = element_rect(fill='transparent')) + #transparent legend pane
theme_pubr()
parasite_innoc
#How does sterilization influence fungal presence
parasite_mean <- parasite_micro %>%
filter(prop_total != 0) %>%
group_by(treatment) %>%
summarise(mean = mean(prop_hyphae), se = sd(prop_hyphae)/sqrt(n()))
host_mean <- host_micro %>%
filter(prop_total != 0) %>%
group_by(treatment) %>%
summarise(mean = mean(prop_hyphae), se = sd(prop_hyphae)/sqrt(n()))
parasite_innoc <- ggplot(host_mean, aes(x = treatment, y = mean, fill = treatment)) +
geom_col(position = position_dodge(0.7), width = .6, linewidth = 0.75, alpha = 0.9, size = 0.1) +
geom_errorbar(aes(ymin = mean-se, ymax = mean+se),
position =  position_dodge(width = 0.7), width = 0.15) +
labs(x = "Pot combination", y = "Parasite Aboveground Biomass") +
scale_fill_manual(values=c("#4b3b40","#b6ad90")) +
theme(panel.background = element_rect(fill='transparent'), #transparent panel bg
plot.background = element_rect(fill='transparent', color=NA), #transparent plot bg
legend.background = element_rect(fill='transparent'), #transparent legend bg
legend.box.background = element_rect(fill='transparent')) + #transparent legend pane
theme_pubr()
parasite_innoc
View(host_parasite_micro)
host_mean <- host_parasite_micro %>%
filter(prop_total != 0) %>%
group_by(treatment, root_type) %>%
summarise(mean = mean(prop_hyphae), se = sd(prop_hyphae)/sqrt(n()))
View(host_mean)
parasite_innoc <- ggplot(host_mean, aes(x = root_type, y = mean, fill = treatment)) +
geom_col(position = position_dodge(0.7), width = .6, linewidth = 0.75, alpha = 0.9, size = 0.1) +
geom_errorbar(aes(ymin = mean-se, ymax = mean+se),
position =  position_dodge(width = 0.7), width = 0.15) +
labs(x = "Pot combination", y = "Parasite Aboveground Biomass") +
scale_fill_manual(values=c("#4b3b40","#b6ad90", "#45463e")) +
theme(panel.background = element_rect(fill='transparent'), #transparent panel bg
plot.background = element_rect(fill='transparent', color=NA), #transparent plot bg
legend.background = element_rect(fill='transparent'), #transparent legend bg
legend.box.background = element_rect(fill='transparent')) + #transparent legend pane
theme_pubr()
parasite_innoc
host_mean <- host_parasite_micro %>%
filter(prop_total != 0) %>%
group_by(treatment, root_type) %>%
summarise(mean = mean(prop_total), se = sd(prop_total)/sqrt(n()))
parasite_innoc <- ggplot(host_mean, aes(x = root_type, y = mean, fill = treatment)) +
geom_col(position = position_dodge(0.7), width = .6, linewidth = 0.75, alpha = 0.9, size = 0.1) +
geom_errorbar(aes(ymin = mean-se, ymax = mean+se),
position =  position_dodge(width = 0.7), width = 0.15) +
labs(x = "Pot combination", y = "Parasite Aboveground Biomass") +
scale_fill_manual(values=c("#4b3b40","#b6ad90", "#45463e")) +
theme(panel.background = element_rect(fill='transparent'), #transparent panel bg
plot.background = element_rect(fill='transparent', color=NA), #transparent plot bg
legend.background = element_rect(fill='transparent'), #transparent legend bg
legend.box.background = element_rect(fill='transparent')) + #transparent legend pane
theme_pubr()
parasite_innoc
parasite_innoc <- ggplot(host_mean, aes(x = root_type, y = mean, fill = treatment)) +
geom_col(position = position_dodge(0.7), width = .6, linewidth = 0.75, alpha = 0.9, size = 0.1) +
geom_errorbar(aes(ymin = mean-se, ymax = mean+se),
position =  position_dodge(width = 0.7), width = 0.15) +
labs(x = "Pot combination", y = "Prop colonized") +
scale_fill_manual(values=c("#4b3b40","#b6ad90", "#45463e")) +
theme(panel.background = element_rect(fill='transparent'), #transparent panel bg
plot.background = element_rect(fill='transparent', color=NA), #transparent plot bg
legend.background = element_rect(fill='transparent'), #transparent legend bg
legend.box.background = element_rect(fill='transparent')) + #transparent legend pane
theme_pubr()
parasite_innoc
write.csv(castilleja.cover, "Processed Data/Total Castilleja cover.csv", row.names=FALSE)
setwd("/Users/jargrett/Desktop/Castilleja/Data Analysis/RMBL Castilleja Observational Project")
#load in relevant packages
library(tidyverse)#for data wrangling and restructuring
library(statmod)
library(performance)#this is new
library(see)#this is new
library(patchwork)
library(rstatix)
library(vegan)#for diversity analysis
#Diversity and Cover data file (combined in excel)
castilleja.cover <- read.csv("Processed Data/castilleja cover complete.csv")
castilleja.cover$castilleja[castilleja.cover$castilleja == "Control"] <- "Absent"
castilleja.cover$castilleja[castilleja.cover$castilleja == "Castilleja"] <- "Present"
castilleja.cover <- as.data.frame(unclass(castilleja.cover),stringsAsFactors=TRUE)
write.csv(castilleja.cover, "Processed Data/Total Castilleja Cover.csv", row.names=FALSE)
setwd("/Users/jargrett/Desktop/Castilleja/Data Analysis/RMBL Castilleja Observational Project")
#Packages
library(ggplot2)
library(ggpubr)
library(hrbrthemes)
castilleja.cover <- read.csv("Total Castilleja Cover.csv")
saveRDS(castilleja.cover,"Processed Data/Total Castilleja Cover.csv")
castilleja.cover <- readRDS("Processed Data/Total Castilleja Cover.csv")
castilleja.cover <- readRDS("Processed Data/Total Castilleja Cover.csv")
setwd("/Users/jargrett/Desktop/Castilleja/Data Analysis/RMBL Castilleja Observational Project")
#--------------------------Multivariate analysis-------------------------------#
#we will now run a (Multivariate analysis)
#This allows us to look at the compositional differences between our sites,castilleja,etc.
#we are working towards Matrix format so we can take our castilleja matrix as our starting point
library(ggrepel)
library(vegan)
library(ggordiplots)
library(tidyverse)#for data wrangling and restructuring
library(statmod)
library(lme4)#for modeling linear mixed effect models
library(emmeans)#post-hoc analysis
library(car)#for regression analysis
library(performance)#this is new
library(see)#this is new
library(lmerTest)
library(patchwork)
library(ggpubr)
library(rstatix)
castilleja.cover <- readRDS("Processed Data/Total Castilleja Cover.csv")
species.matrix <- castilleja.cover[ -c(1:16)]
species.env <- subset(castilleja.cover, select=c(1:8))
#First calculate distance matrix
dist <-vegdist(species.matrix, method="bray")
set.seed(20)
#Run NMDS on distance matrix
nmds <- metaMDS(dist, distance="bray", #use bray-curtis distance
k=2, #2 dimensions
try=500) #for publication I recommend 500)
nmds#stress value 0.14 which is below .2 so we need to investigate
ordiplot(nmds, type="text", display="sites")
nmds.scores <- as.data.frame(vegan::scores(nmds))
NMDS <- cbind(species.env,nmds.scores) #final dataset
saveRDS(NMDS,"NMDS.rds")
perm <- adonis2(dist ~ castilleja*species + castilleja*year + castilleja*site, data = NMDS, permutations=9999)
perm
setwd("/Users/jargrett/Desktop/Castilleja/Data Analysis/RMBL Castilleja Observational Project")
#load in relevant packages
library(tidyverse)#for data wrangling and restructuring
library(statmod)
library(performance)#this is new
library(see)#this is new
library(patchwork)
library(rstatix)
library(vegan)#for diversity analysis
#Diversity and Cover data file (combined in excel)
castilleja.cover <- read.csv("Processed Data/castilleja cover complete.csv")
castilleja.cover$castilleja[castilleja.cover$castilleja == "Control"] <- "Absent"
castilleja.cover$castilleja[castilleja.cover$castilleja == "Castilleja"] <- "Present"
castilleja.cover <- as.data.frame(unclass(castilleja.cover),stringsAsFactors=TRUE)
saveRDS(castilleja.cover,"Processed Data/Total Castilleja Cover.rds")
setwd("/Users/jargrett/Desktop/Castilleja/Data Analysis/RMBL Castilleja Observational Project")
#--------------------------Multivariate analysis-------------------------------#
#we will now run a (Multivariate analysis)
#This allows us to look at the compositional differences between our sites,castilleja,etc.
#we are working towards Matrix format so we can take our castilleja matrix as our starting point
library(ggrepel)
library(vegan)
library(ggordiplots)
library(tidyverse)#for data wrangling and restructuring
library(statmod)
library(lme4)#for modeling linear mixed effect models
library(emmeans)#post-hoc analysis
library(car)#for regression analysis
library(performance)#this is new
library(see)#this is new
library(lmerTest)
library(patchwork)
library(ggpubr)
library(rstatix)
castilleja.cover <- readRDS("Processed Data/Total Castilleja Cover.rds")
species.matrix <- castilleja.cover[ -c(1:16)]
species.env <- subset(castilleja.cover, select=c(1:8))
#First calculate distance matrix
dist <-vegdist(species.matrix, method="bray")
set.seed(20)
#Run NMDS on distance matrix
nmds <- metaMDS(dist, distance="bray", #use bray-curtis distance
k=2, #2 dimensions
try=500) #for publication I recommend 500)
nmds#stress value 0.14 which is below .2 so we need to investigate
ordiplot(nmds, type="text", display="sites")
nmds.scores <- as.data.frame(vegan::scores(nmds))
NMDS <- cbind(species.env,nmds.scores) #final dataset
saveRDS(NMDS,"NMDS.rds")
perm <- adonis2(dist ~ castilleja*species + castilleja*year + castilleja*site, data = NMDS, permutations=9999)
perm
cap.mod <- capscale(dist ~ castilleja*species + castilleja*year + castilleja*site +
Condition(PlotID),
data = NMDS)
View(NMDS)
cap.mod <- capscale(dist ~ castilleja*species + castilleja*year + castilleja*site +
Condition(pair),
data = NMDS)
cap.mod
install.packages("permute")
library(permute)
perm <- how(blocks = NMDS$pair, nperm = 9999)
anova(cap.mod, permutations = perm)
anova(cap.mod, permutations = perm, by = "terms")
cap.mod <- capscale(dist ~ castilleja*species + castilleja*year + castilleja*site + Condition(plot),
data = NMDS)
perm <- how(blocks = NMDS$plot, nperm = 9999)
anova(cap.mod, permutations = perm, by = "terms")
cap.mod <- capscale(dist ~ castilleja*species + castilleja*year + castilleja*site + Condition(plot),
data = NMDS)
perm <- how(blocks = NMDS$plot, nperm = 9999)
anova(cap.mod, permutations = perm, by = "terms")
anova(cap.mod, permutations = perm, by = "terms")
setwd("/Users/jargrett/Desktop/Castilleja/Data Analysis/RMBL Castilleja Observational Project")
#--------------------------Multivariate analysis-------------------------------#
#we will now run a (Multivariate analysis)
#This allows us to look at the compositional differences between our sites,castilleja,etc.
#we are working towards Matrix format so we can take our castilleja matrix as our starting point
library(ggrepel)
library(vegan)
library(ggordiplots)
library(tidyverse)#for data wrangling and restructuring
library(statmod)
library(lme4)#for modeling linear mixed effect models
library(emmeans)#post-hoc analysis
library(car)#for regression analysis
library(performance)#this is new
library(see)#this is new
library(lmerTest)
library(patchwork)
library(ggpubr)
library(rstatix)
library(permute)
castilleja.cover <- readRDS("Processed Data/Total Castilleja Cover.rds")
species.matrix <- castilleja.cover[ -c(1:16)]
species.env <- subset(castilleja.cover, select=c(1:8))
#First calculate distance matrix
dist <-vegdist(species.matrix, method="bray")
set.seed(20)
#Run NMDS on distance matrix
nmds <- metaMDS(dist, distance="bray", #use bray-curtis distance
k=2, #2 dimensions
try=500) #for publication I recommend 500)
nmds#stress value 0.14 which is below .2 so we need to investigate
ordiplot(nmds, type="text", display="sites")
nmds.scores <- as.data.frame(vegan::scores(nmds))
NMDS <- cbind(species.env,nmds.scores) #final dataset
saveRDS(NMDS,"NMDS.rds")
cap.mod <- capscale(dist ~ castilleja*species + castilleja*year + castilleja*site + Condition(plot),
data = NMDS)
perm <- how(blocks = NMDS$plot, nperm = 9999)
anova(cap.mod, permutations = perm, by = "terms")
cap.mod <- capscale(dist ~ castilleja*species + castilleja*year + castilleja*site + Condition(plot),
data = NMDS)
perm <- how(blocks = NMDS$plot, nperm = 999)
anova(cap.mod, permutations = perm, by = "terms")
cap.mod <- capscale(dist ~ castilleja*species + castilleja*year + castilleja*site + Condition(pair),
data = NMDS)
perm <- how(blocks = NMDS$pair, nperm = 9999)
anova(cap.mod, permutations = perm, by = "terms")
plot(cap.mod, display = "sites")
cap.mod <- capscale(dist ~ castilleja*species + castilleja*year + castilleja*site + Condition(pair),
data = NMDS, metaMDSdist = TRUE)
View(NMDS)
cap.mod <- capscale(dist ~ castilleja*species + castilleja*year + castilleja*site + Condition(pair),
data = NMDS, metaMDSdist = TRUE)
sppscores(cap.mod)
